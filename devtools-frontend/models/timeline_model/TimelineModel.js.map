{"version":3,"file":"TimelineModel.js","sourceRoot":"","sources":["../../../../../../front_end/models/timeline_model/TimelineModel.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2012 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as TraceEngine from '../trace/trace.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport {TimelineJSProfileProcessor} from './TimelineJSProfile.js';\n\nconst UIStrings = {\n  /**\n   *@description Text for the name of a thread of the page\n   *@example {1} PH1\n   */\n  threadS: 'Thread {PH1}',\n  /**\n   *@description Title of a worker in the timeline flame chart of the Performance panel\n   *@example {https://google.com} PH1\n   */\n  workerS: '`Worker`  {PH1}',\n  /**\n   *@description Title of a worker in the timeline flame chart of the Performance panel\n   */\n  dedicatedWorker: 'Dedicated `Worker`',\n  /**\n   *@description Title of a worker in the timeline flame chart of the Performance panel\n   *@example {FormatterWorker} PH1\n   *@example {https://google.com} PH2\n   */\n  workerSS: '`Worker`: {PH1}  {PH2}',\n\n  /**\n   *@description Title of a bidder auction worklet with known URL in the timeline flame chart of the Performance panel\n   *@example {https://google.com} PH1\n   */\n  bidderWorkletS: 'Bidder Worklet  {PH1}',\n\n  /**\n   *@description Title of a seller auction worklet with known URL in the timeline flame chart of the Performance panel\n   *@example {https://google.com} PH1\n   */\n  sellerWorkletS: 'Seller Worklet  {PH1}',\n\n  /**\n   *@description Title of an auction worklet with known URL in the timeline flame chart of the Performance panel\n   *@example {https://google.com} PH1\n   */\n  unknownWorkletS: 'Auction Worklet  {PH1}',\n\n  /**\n   *@description Title of a bidder auction worklet in the timeline flame chart of the Performance panel\n   */\n  bidderWorklet: 'Bidder Worklet',\n\n  /**\n   *@description Title of a seller auction worklet in the timeline flame chart of the Performance panel\n   */\n  sellerWorklet: 'Seller Worklet',\n\n  /**\n   *@description Title of an auction worklet in the timeline flame chart of the Performance panel\n   */\n  unknownWorklet: 'Auction Worklet',\n\n  /**\n   *@description Title of control thread of a service process for an auction worklet in the timeline flame chart of the Performance panel\n   */\n  workletService: 'Auction Worklet Service',\n\n  /**\n   *@description Title of control thread of a service process for an auction worklet with known URL in the timeline flame chart of the Performance panel\n   * @example {https://google.com} PH1\n   */\n  workletServiceS: 'Auction Worklet Service  {PH1}',\n\n};\nconst str_ = i18n.i18n.registerUIStrings('models/timeline_model/TimelineModel.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class TimelineModelImpl {\n  private isGenericTraceInternal!: boolean;\n  private tracksInternal!: Track[];\n  private namedTracks!: Map<TrackType, Track>;\n  private inspectedTargetEventsInternal!: SDK.TracingModel.Event[];\n  private timeMarkerEventsInternal!: SDK.TracingModel.Event[];\n  private sessionId!: string|null;\n  private mainFrameNodeId!: number|null;\n  private pageFrames!: Map<Protocol.Page.FrameId, PageFrame>;\n  private auctionWorklets!: Map<string, AuctionWorklet>;\n  private cpuProfilesInternal!: SDK.CPUProfileDataModel.CPUProfileDataModel[];\n  private workerIdByThread!: WeakMap<SDK.TracingModel.Thread, string>;\n  private requestsFromBrowser!: Map<string, SDK.TracingModel.Event>;\n  private mainFrame!: PageFrame;\n  private minimumRecordTimeInternal: number;\n  private maximumRecordTimeInternal: number;\n  private totalBlockingTimeInternal: number;\n  private estimatedTotalBlockingTime: number;\n  private asyncEventTracker!: TimelineAsyncEventTracker;\n  private invalidationTracker!: InvalidationTracker;\n  private layoutInvalidate!: {\n    [x: string]: SDK.TracingModel.Event|null,\n  };\n  private lastScheduleStyleRecalculation!: {\n    [x: string]: SDK.TracingModel.Event,\n  };\n  private paintImageEventByPixelRefId!: {\n    [x: string]: SDK.TracingModel.Event,\n  };\n  private lastPaintForLayer!: {\n    [x: string]: SDK.TracingModel.Event,\n  };\n  private lastRecalculateStylesEvent!: SDK.TracingModel.Event|null;\n  private currentScriptEvent!: SDK.TracingModel.Event|null;\n  private eventStack!: SDK.TracingModel.Event[];\n  private browserFrameTracking!: boolean;\n  private persistentIds!: boolean;\n  private legacyCurrentPage!: any;\n  private currentTaskLayoutAndRecalcEvents: SDK.TracingModel.Event[];\n  private tracingModelInternal: SDK.TracingModel.TracingModel|null;\n  private mainFrameLayerTreeId?: any;\n  #isFreshRecording = false;\n\n  constructor() {\n    this.minimumRecordTimeInternal = 0;\n    this.maximumRecordTimeInternal = 0;\n    this.totalBlockingTimeInternal = 0;\n    this.estimatedTotalBlockingTime = 0;\n\n    this.reset();\n    this.resetProcessingState();\n\n    this.currentTaskLayoutAndRecalcEvents = [];\n    this.tracingModelInternal = null;\n  }\n\n  /**\n   * Iterates events in a tree hierarchically, from top to bottom,\n   * calling back on every event's start and end in the order\n   * dictated by the corresponding timestamp.\n   *\n   * Events are assumed to be in ascendent order by timestamp.\n   *\n   * For example, given this tree, the following callbacks\n   * are expected to be made in the following order\n   * |---------------A---------------|\n   *  |------B------||-------D------|\n   *    |---C---|\n   *\n   * 1. Start A\n   * 3. Start B\n   * 4. Start C\n   * 5. End C\n   * 6. End B\n   * 7. Start D\n   * 8. End D\n   * 9. End A\n   *\n   * By default, async events are filtered. This behaviour can be\n   * overriden making use of the filterAsyncEvents parameter.\n   */\n  static forEachEvent(\n      events: SDK.TracingModel.CompatibleTraceEvent[],\n      onStartEvent: (arg0: SDK.TracingModel.CompatibleTraceEvent) => void,\n      onEndEvent: (arg0: SDK.TracingModel.CompatibleTraceEvent) => void,\n      onInstantEvent?:\n          ((arg0: SDK.TracingModel.CompatibleTraceEvent, arg1: SDK.TracingModel.CompatibleTraceEvent|null) => void),\n      startTime?: number, endTime?: number, filter?: ((arg0: SDK.TracingModel.CompatibleTraceEvent) => boolean),\n      ignoreAsyncEvents = true): void {\n    startTime = startTime || 0;\n    endTime = endTime || Infinity;\n    const stack: SDK.TracingModel.CompatibleTraceEvent[] = [];\n    const startEvent = TimelineModelImpl.topLevelEventEndingAfter(events, startTime);\n    for (let i = startEvent; i < events.length; ++i) {\n      const e = events[i];\n      const {endTime: eventEndTime, startTime: eventStartTime, duration: eventDuration} =\n          SDK.TracingModel.timesForEventInMilliseconds(e);\n      const eventPhase = SDK.TracingModel.phaseForEvent(e);\n      if ((eventEndTime || eventStartTime) < startTime) {\n        continue;\n      }\n      if (eventStartTime >= endTime) {\n        break;\n      }\n      const canIgnoreAsyncEvent = ignoreAsyncEvents && TraceEngine.Types.TraceEvents.isAsyncPhase(eventPhase);\n      if (canIgnoreAsyncEvent || TraceEngine.Types.TraceEvents.isFlowPhase(eventPhase)) {\n        continue;\n      }\n      let last = stack[stack.length - 1];\n      let lastEventEndTime = last && SDK.TracingModel.timesForEventInMilliseconds(last).endTime;\n      while (last && lastEventEndTime !== undefined && lastEventEndTime <= eventStartTime) {\n        stack.pop();\n        onEndEvent(last);\n        last = stack[stack.length - 1];\n        lastEventEndTime = last && SDK.TracingModel.timesForEventInMilliseconds(last).endTime;\n      }\n\n      if (filter && !filter(e)) {\n        continue;\n      }\n      if (eventDuration) {\n        onStartEvent(e);\n        stack.push(e);\n      } else {\n        onInstantEvent && onInstantEvent(e, stack[stack.length - 1] || null);\n      }\n    }\n    while (stack.length) {\n      const last = stack.pop();\n      if (last) {\n        onEndEvent(last);\n      }\n    }\n  }\n\n  private static topLevelEventEndingAfter(events: SDK.TracingModel.CompatibleTraceEvent[], time: number): number {\n    let index =\n        Platform.ArrayUtilities.upperBound(\n            events, time, (time, event) => time - SDK.TracingModel.timesForEventInMilliseconds(event).startTime) -\n        1;\n    while (index > 0 && !SDK.TracingModel.TracingModel.isTopLevelEvent(events[index])) {\n      index--;\n    }\n    return Math.max(index, 0);\n  }\n\n  mainFrameID(): string {\n    return this.mainFrame.frameId;\n  }\n\n  /**\n   * Determines if an event is potentially a marker event. A marker event here\n   * is a single moment in time that we want to highlight on the timeline, such as\n   * the LCP point. This method does not filter out events: for example, it treats\n   * every LCP Candidate event as a potential marker event. The logic to pick the\n   * right candidate to use is implemeneted in the TimelineFlameChartDataProvider.\n   **/\n  isMarkerEvent(event: SDK.TracingModel.CompatibleTraceEvent): boolean {\n    switch (event.name) {\n      case RecordType.TimeStamp:\n        return true;\n      case RecordType.MarkFirstPaint:\n      case RecordType.MarkFCP:\n        return Boolean(this.mainFrame) && event.args.frame === this.mainFrame.frameId && Boolean(event.args.data);\n      case RecordType.MarkDOMContent:\n      case RecordType.MarkLoad:\n      case RecordType.MarkLCPCandidate:\n      case RecordType.MarkLCPInvalidate:\n        return Boolean(event.args['data']['isOutermostMainFrame'] ?? event.args['data']['isMainFrame']);\n      default:\n        return false;\n    }\n  }\n\n  isInteractiveTimeEvent(event: SDK.TracingModel.Event): boolean {\n    return event.name === RecordType.InteractiveTime;\n  }\n\n  isLayoutShiftEvent(event: SDK.TracingModel.Event): boolean {\n    return event.name === RecordType.LayoutShift;\n  }\n\n  isParseHTMLEvent(event: SDK.TracingModel.Event): boolean {\n    return event.name === RecordType.ParseHTML;\n  }\n\n  static isJsFrameEvent(event: SDK.TracingModel.CompatibleTraceEvent): boolean {\n    return event.name === RecordType.JSFrame || event.name === RecordType.JSIdleFrame ||\n        event.name === RecordType.JSSystemFrame;\n  }\n\n  static globalEventId(event: SDK.TracingModel.Event, field: string): string {\n    const data = event.args['data'] || event.args['beginData'];\n    const id = data && data[field];\n    if (!id) {\n      return '';\n    }\n    return `${event.thread.process().id()}.${id}`;\n  }\n\n  static eventFrameId(event: SDK.TracingModel.Event): Protocol.Page.FrameId|null {\n    const data = event.args['data'] || event.args['beginData'];\n    return data && data['frame'] || null;\n  }\n\n  cpuProfiles(): SDK.CPUProfileDataModel.CPUProfileDataModel[] {\n    return this.cpuProfilesInternal;\n  }\n\n  totalBlockingTime(): {\n    time: number,\n    estimated: boolean,\n  } {\n    if (this.totalBlockingTimeInternal === -1) {\n      return {time: this.estimatedTotalBlockingTime, estimated: true};\n    }\n\n    return {time: this.totalBlockingTimeInternal, estimated: false};\n  }\n\n  targetByEvent(event: SDK.TracingModel.CompatibleTraceEvent): SDK.Target.Target|null {\n    let thread;\n    if (event instanceof SDK.TracingModel.Event) {\n      thread = event.thread;\n    } else {\n      const process = this.tracingModelInternal?.getProcessById(event.pid);\n      thread = process?.threadById(event.tid);\n    }\n    if (!thread) {\n      return null;\n    }\n    // FIXME: Consider returning null for loaded traces.\n    const workerId = this.workerIdByThread.get(thread);\n    const primaryPageTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    return workerId ? SDK.TargetManager.TargetManager.instance().targetById(workerId) : primaryPageTarget;\n  }\n\n  navStartTimes(): Map<string, SDK.TracingModel.PayloadEvent> {\n    if (!this.tracingModelInternal) {\n      return new Map();\n    }\n\n    return this.tracingModelInternal.navStartTimes();\n  }\n\n  isFreshRecording(): boolean {\n    return this.#isFreshRecording;\n  }\n\n  setEvents(tracingModel: SDK.TracingModel.TracingModel, isFreshRecording: boolean = false): void {\n    this.#isFreshRecording = isFreshRecording;\n    this.reset();\n    this.resetProcessingState();\n    this.tracingModelInternal = tracingModel;\n\n    this.minimumRecordTimeInternal = tracingModel.minimumRecordTime();\n    this.maximumRecordTimeInternal = tracingModel.maximumRecordTime();\n\n    // Remove LayoutShift events from the main thread list of events because they are\n    // represented in the experience track. This is done prior to the main thread being processed for its own events.\n    const layoutShiftEvents = [];\n    for (const process of tracingModel.sortedProcesses()) {\n      if (process.name() !== 'Renderer') {\n        continue;\n      }\n\n      for (const thread of process.sortedThreads()) {\n        const shifts = thread.removeEventsByName(RecordType.LayoutShift);\n        layoutShiftEvents.push(...shifts);\n      }\n    }\n\n    this.processSyncBrowserEvents(tracingModel);\n    if (this.browserFrameTracking) {\n      this.processThreadsForBrowserFrames(tracingModel);\n    } else {\n      // The next line is for loading legacy traces recorded before M67.\n      // TODO(alph): Drop the support at some point.\n      const metadataEvents = this.processMetadataEvents(tracingModel);\n      this.isGenericTraceInternal = !metadataEvents;\n      if (metadataEvents) {\n        this.processMetadataAndThreads(tracingModel, metadataEvents);\n      } else {\n        this.processGenericTrace(tracingModel);\n      }\n    }\n    this.inspectedTargetEventsInternal.sort(SDK.TracingModel.Event.compareStartTime);\n    this.processAsyncBrowserEvents(tracingModel);\n    this.resetProcessingState();\n  }\n\n  private processGenericTrace(tracingModel: SDK.TracingModel.TracingModel): void {\n    let browserMainThread = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (!browserMainThread && tracingModel.sortedProcesses().length) {\n      browserMainThread = tracingModel.sortedProcesses()[0].sortedThreads()[0];\n    }\n    for (const process of tracingModel.sortedProcesses()) {\n      for (const thread of process.sortedThreads()) {\n        this.processThreadEvents(\n            tracingModel, thread, thread === browserMainThread, false, true, WorkletType.NotWorklet, null);\n      }\n    }\n  }\n\n  private processMetadataAndThreads(tracingModel: SDK.TracingModel.TracingModel, metadataEvents: MetadataEvents): void {\n    let startTime = 0;\n    for (let i = 0, length = metadataEvents.page.length; i < length; i++) {\n      const metaEvent = metadataEvents.page[i];\n      const process = metaEvent.thread.process();\n      const endTime = i + 1 < length ? metadataEvents.page[i + 1].startTime : Infinity;\n      if (startTime === endTime) {\n        continue;\n      }\n      this.legacyCurrentPage = metaEvent.args['data'] && metaEvent.args['data']['page'];\n      for (const thread of process.sortedThreads()) {\n        let workerUrl: Platform.DevToolsPath.UrlString|null = null;\n        if (thread.name() === TimelineModelImpl.WorkerThreadName ||\n            thread.name() === TimelineModelImpl.WorkerThreadNameLegacy) {\n          const workerMetaEvent = metadataEvents.workers.find(e => {\n            if (e.args['data']['workerThreadId'] !== thread.id()) {\n              return false;\n            }\n            // This is to support old traces.\n            if (e.args['data']['sessionId'] === this.sessionId) {\n              return true;\n            }\n            const frameId = TimelineModelImpl.eventFrameId(e);\n            return frameId ? Boolean(this.pageFrames.get(frameId)) : false;\n          });\n          if (!workerMetaEvent) {\n            continue;\n          }\n          const workerId = workerMetaEvent.args['data']['workerId'];\n          if (workerId) {\n            this.workerIdByThread.set(thread, workerId);\n          }\n          workerUrl = workerMetaEvent.args['data']['url'] || Platform.DevToolsPath.EmptyUrlString;\n        }\n        this.processThreadEvents(\n            tracingModel, thread, thread === metaEvent.thread, Boolean(workerUrl), true, WorkletType.NotWorklet,\n            workerUrl);\n      }\n      startTime = endTime;\n    }\n  }\n\n  private processThreadsForBrowserFrames(tracingModel: SDK.TracingModel.TracingModel): void {\n    const processDataByPid = new Map<number, {\n      from: number,\n      to: number,\n      main: boolean,\n      workletType: WorkletType,\n      url: Platform.DevToolsPath.UrlString,\n    }[]>();\n    for (const frame of this.pageFrames.values()) {\n      for (let i = 0; i < frame.processes.length; i++) {\n        const pid = frame.processes[i].processId;\n        let data = processDataByPid.get(pid);\n        if (!data) {\n          data = [];\n          processDataByPid.set(pid, data);\n        }\n        const to = i === frame.processes.length - 1 ? (frame.deletedTime || Infinity) : frame.processes[i + 1].time;\n        data.push({\n          from: frame.processes[i].time,\n          to: to,\n          main: !frame.parent,\n          url: frame.processes[i].url,\n          workletType: WorkletType.NotWorklet,\n        });\n      }\n    }\n    for (const auctionWorklet of this.auctionWorklets.values()) {\n      const pid = auctionWorklet.processId;\n      let data = processDataByPid.get(pid);\n      if (!data) {\n        data = [];\n        processDataByPid.set(pid, data);\n      }\n      data.push({\n        from: auctionWorklet.startTime,\n        to: auctionWorklet.endTime,\n        main: false,\n        workletType: auctionWorklet.workletType,\n        url:\n            (auctionWorklet.host ? 'https://' + auctionWorklet.host as Platform.DevToolsPath.UrlString :\n                                   Platform.DevToolsPath.EmptyUrlString),\n      });\n    }\n    const allMetadataEvents = tracingModel.devToolsMetadataEvents();\n    for (const process of tracingModel.sortedProcesses()) {\n      const processData = processDataByPid.get(process.id());\n      if (!processData) {\n        continue;\n      }\n      // Sort ascending by range starts, followed by range ends\n      processData.sort((a, b) => a.from - b.from || a.to - b.to);\n\n      let lastUrl: Platform.DevToolsPath.UrlString|null = null;\n      let lastMainUrl: Platform.DevToolsPath.UrlString|null = null;\n      let hasMain = false;\n\n      let allWorklet = true;\n      // false: not set, true: inconsistent.\n      let workletUrl: Platform.DevToolsPath.UrlString|boolean = false;\n      // NotWorklet used for not set.\n      let workletType: WorkletType = WorkletType.NotWorklet;\n\n      for (const item of processData) {\n        if (item.main) {\n          hasMain = true;\n        }\n        if (item.url) {\n          if (item.main) {\n            lastMainUrl = item.url;\n          }\n          lastUrl = item.url;\n        }\n\n        // Worklet identification\n        if (item.workletType === WorkletType.NotWorklet) {\n          allWorklet = false;\n        } else {\n          // Update combined workletUrl, checking for inconsistencies.\n          if (workletUrl === false) {\n            workletUrl = item.url;\n          } else if (workletUrl !== item.url) {\n            workletUrl = true;  // Process used for different things.\n          }\n\n          if (workletType === WorkletType.NotWorklet) {\n            workletType = item.workletType;\n          } else if (workletType !== item.workletType) {\n            workletType = WorkletType.UnknownWorklet;\n          }\n        }\n      }\n\n      for (const thread of process.sortedThreads()) {\n        if (thread.name() === TimelineModelImpl.RendererMainThreadName) {\n          this.processThreadEvents(\n              tracingModel, thread, true /* isMainThread */, false /* isWorker */, hasMain, WorkletType.NotWorklet,\n              hasMain ? lastMainUrl : lastUrl);\n        } else if (\n            thread.name() === TimelineModelImpl.WorkerThreadName ||\n            thread.name() === TimelineModelImpl.WorkerThreadNameLegacy) {\n          const workerMetaEvent = allMetadataEvents.find(e => {\n            if (e.name !== TimelineModelImpl.DevToolsMetadataEvent.TracingSessionIdForWorker) {\n              return false;\n            }\n            if (e.thread.process() !== process) {\n              return false;\n            }\n            if (e.args['data']['workerThreadId'] !== thread.id()) {\n              return false;\n            }\n            const frameId = TimelineModelImpl.eventFrameId(e);\n            return frameId ? Boolean(this.pageFrames.get(frameId)) : false;\n          });\n          if (!workerMetaEvent) {\n            continue;\n          }\n          this.workerIdByThread.set(thread, workerMetaEvent.args['data']['workerId'] || '');\n          this.processThreadEvents(\n              tracingModel, thread, false /* isMainThread */, true /* isWorker */, false /* forMainFrame */,\n              WorkletType.NotWorklet, workerMetaEvent.args['data']['url'] || Platform.DevToolsPath.EmptyUrlString);\n        } else {\n          let urlForOther: Platform.DevToolsPath.UrlString|null = null;\n          let workletTypeForOther: WorkletType = WorkletType.NotWorklet;\n          if (thread.name() === TimelineModelImpl.AuctionWorkletThreadName ||\n              thread.name().endsWith(TimelineModelImpl.UtilityMainThreadNameSuffix)) {\n            if (typeof workletUrl !== 'boolean') {\n              urlForOther = workletUrl;\n            }\n            workletTypeForOther = workletType;\n          } else {\n            // For processes that only do auction worklet things, skip other threads.\n            if (allWorklet) {\n              continue;\n            }\n          }\n          this.processThreadEvents(\n              tracingModel, thread, false /* isMainThread */, false /* isWorker */, false /* forMainFrame */,\n              workletTypeForOther, urlForOther);\n        }\n      }\n    }\n  }\n\n  private processMetadataEvents(tracingModel: SDK.TracingModel.TracingModel): MetadataEvents|null {\n    const metadataEvents = tracingModel.devToolsMetadataEvents();\n\n    const pageDevToolsMetadataEvents = [];\n    const workersDevToolsMetadataEvents = [];\n    for (const event of metadataEvents) {\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInPage) {\n        pageDevToolsMetadataEvents.push(event);\n        if (event.args['data'] && event.args['data']['persistentIds']) {\n          this.persistentIds = true;\n        }\n        const frames = ((event.args['data'] && event.args['data']['frames']) || [] as PageFrame[]);\n        frames.forEach((payload: PageFrame) => this.addPageFrame(event, payload));\n        this.mainFrame = this.rootFrames()[0];\n      } else if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingSessionIdForWorker) {\n        workersDevToolsMetadataEvents.push(event);\n      } else if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInBrowser) {\n        console.assert(!this.mainFrameNodeId, 'Multiple sessions in trace');\n        this.mainFrameNodeId = event.args['frameTreeNodeId'];\n      }\n    }\n    if (!pageDevToolsMetadataEvents.length) {\n      return null;\n    }\n\n    const sessionId =\n        pageDevToolsMetadataEvents[0].args['sessionId'] || pageDevToolsMetadataEvents[0].args['data']['sessionId'];\n    this.sessionId = sessionId;\n\n    const mismatchingIds = new Set<any>();\n    function checkSessionId(event: SDK.TracingModel.Event): boolean {\n      let args = event.args;\n      // FIXME: put sessionId into args[\"data\"] for TracingStartedInPage event.\n      if (args['data']) {\n        args = args['data'];\n      }\n      const id = args['sessionId'];\n      if (id === sessionId) {\n        return true;\n      }\n      mismatchingIds.add(id);\n      return false;\n    }\n    const result = {\n      page: pageDevToolsMetadataEvents.filter(checkSessionId).sort(SDK.TracingModel.Event.compareStartTime),\n      workers: workersDevToolsMetadataEvents.sort(SDK.TracingModel.Event.compareStartTime),\n    };\n    if (mismatchingIds.size) {\n      Common.Console.Console.instance().error(\n          'Timeline recording was started in more than one page simultaneously. Session id mismatch: ' +\n          this.sessionId + ' and ' + [...mismatchingIds] + '.');\n    }\n    return result;\n  }\n\n  private processSyncBrowserEvents(tracingModel: SDK.TracingModel.TracingModel): void {\n    const browserMain = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (browserMain) {\n      browserMain.events().forEach(this.processBrowserEvent, this);\n    }\n  }\n\n  private processAsyncBrowserEvents(tracingModel: SDK.TracingModel.TracingModel): void {\n    const browserMain = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (browserMain) {\n      this.processAsyncEvents(browserMain);\n    }\n  }\n\n  private resetProcessingState(): void {\n    this.asyncEventTracker = new TimelineAsyncEventTracker();\n    this.invalidationTracker = new InvalidationTracker();\n    this.layoutInvalidate = {};\n    this.lastScheduleStyleRecalculation = {};\n    this.paintImageEventByPixelRefId = {};\n    this.lastPaintForLayer = {};\n    this.lastRecalculateStylesEvent = null;\n    this.currentScriptEvent = null;\n    this.eventStack = [];\n    this.browserFrameTracking = false;\n    this.persistentIds = false;\n    this.legacyCurrentPage = null;\n  }\n\n  private extractCpuProfileDataModel(tracingModel: SDK.TracingModel.TracingModel, thread: SDK.TracingModel.Thread):\n      SDK.CPUProfileDataModel.CPUProfileDataModel|null {\n    const events = thread.events();\n    let cpuProfile;\n    let target: (SDK.Target.Target|null)|null = null;\n\n    // Check for legacy CpuProfile event format first.\n    // 'CpuProfile' is currently used by https://webpack.js.org/plugins/profiling-plugin/ and our createFakeTraceFromCpuProfile\n    let cpuProfileEvent = events.at(-1);\n    if (cpuProfileEvent && cpuProfileEvent.name === RecordType.CpuProfile) {\n      const eventData = cpuProfileEvent.args['data'];\n      cpuProfile = (eventData && eventData['cpuProfile'] as Protocol.Profiler.Profile | null);\n      target = this.targetByEvent(cpuProfileEvent);\n    }\n\n    if (!cpuProfile) {\n      cpuProfileEvent = events.find(e => e.name === RecordType.Profile);\n      if (!cpuProfileEvent) {\n        return null;\n      }\n      target = this.targetByEvent(cpuProfileEvent);\n      // Profile groups are created right after a trace is loaded (in\n      // tracing model).\n      // They are created using events with the \"P\" phase (samples),\n      // which includes ProfileChunks with the samples themselves but\n      // also \"Profile\" events with metadata of the profile.\n      // A group is created for each unique profile in each unique\n      // thread.\n      const profileGroup = tracingModel.profileGroup(cpuProfileEvent);\n      if (!profileGroup) {\n        Common.Console.Console.instance().error('Invalid CPU profile format.');\n        return null;\n      }\n      cpuProfile = ({\n        startTime: cpuProfileEvent.startTime * 1000,\n        endTime: 0,\n        nodes: [],\n        samples: [],\n        timeDeltas: [],\n        lines: [],\n      } as any);\n      for (const profileEvent of profileGroup.children) {\n        const eventData = profileEvent.args['data'];\n        if ('startTime' in eventData) {\n          // Do not use |eventData['startTime']| as it is in CLOCK_MONOTONIC domain,\n          // but use |profileEvent.startTime| (|ts| in the trace event) which has\n          // been translated to Perfetto's clock domain.\n          //\n          // Also convert from ms to us.\n          cpuProfile.startTime = profileEvent.startTime * 1000;\n        }\n        if ('endTime' in eventData) {\n          // Do not use |eventData['endTime']| as it is in CLOCK_MONOTONIC domain,\n          // but use |profileEvent.startTime| (|ts| in the trace event) which has\n          // been translated to Perfetto's clock domain.\n          //\n          // Despite its name, |profileEvent.startTime| was recorded right after\n          // |eventData['endTime']| within v8 and is a reasonable substitute.\n          //\n          // Also convert from ms to us.\n          cpuProfile.endTime = profileEvent.startTime * 1000;\n        }\n        const nodesAndSamples = eventData['cpuProfile'] || {};\n        const samples = nodesAndSamples['samples'] || [];\n        const lines = eventData['lines'] || Array(samples.length).fill(0);\n        cpuProfile.nodes.push(...(nodesAndSamples['nodes'] || []));\n        cpuProfile.lines.push(...lines);\n        if (cpuProfile.samples) {\n          cpuProfile.samples.push(...samples);\n        }\n        if (cpuProfile.timeDeltas) {\n          cpuProfile.timeDeltas.push(...(eventData['timeDeltas'] || []));\n        }\n        if (cpuProfile.samples && cpuProfile.timeDeltas && cpuProfile.samples.length !== cpuProfile.timeDeltas.length) {\n          Common.Console.Console.instance().error('Failed to parse CPU profile.');\n          return null;\n        }\n      }\n      if (!cpuProfile.endTime && cpuProfile.timeDeltas) {\n        const timeDeltas: number[] = cpuProfile.timeDeltas;\n        cpuProfile.endTime = timeDeltas.reduce((x, y) => x + y, cpuProfile.startTime);\n      }\n    }\n\n    try {\n      const profile = (cpuProfile as Protocol.Profiler.Profile);\n      const jsProfileModel = new SDK.CPUProfileDataModel.CPUProfileDataModel(profile, target);\n      this.cpuProfilesInternal.push(jsProfileModel);\n      return jsProfileModel;\n    } catch (e) {\n      Common.Console.Console.instance().error('Failed to parse CPU profile.');\n    }\n    return null;\n  }\n\n  private injectJSFrameEvents(tracingModel: SDK.TracingModel.TracingModel, thread: SDK.TracingModel.Thread):\n      SDK.TracingModel.Event[] {\n    const jsProfileModel = this.extractCpuProfileDataModel(tracingModel, thread);\n    let events = thread.events();\n    const jsSamples = jsProfileModel ?\n        TimelineJSProfileProcessor.generateConstructedEventsFromCpuProfileDataModel(jsProfileModel, thread) :\n        null;\n    if (jsSamples && jsSamples.length) {\n      events = Platform.ArrayUtilities.mergeOrdered(events, jsSamples, SDK.TracingModel.Event.orderedCompareStartTime);\n    }\n    if (jsSamples ||\n        events.some(\n            e => e.name === RecordType.JSSample || e.name === RecordType.JSSystemSample ||\n                e.name === RecordType.JSIdleSample)) {\n      const jsFrameEvents = TimelineJSProfileProcessor.generateJSFrameEvents(events, {\n        showAllEvents: Root.Runtime.experiments.isEnabled('timelineShowAllEvents'),\n        showRuntimeCallStats: Root.Runtime.experiments.isEnabled('timelineV8RuntimeCallStats'),\n        showNativeFunctions: Common.Settings.Settings.instance().moduleSetting('showNativeFunctionsInJSProfile').get(),\n      });\n      if (jsFrameEvents && jsFrameEvents.length) {\n        events =\n            Platform.ArrayUtilities.mergeOrdered(jsFrameEvents, events, SDK.TracingModel.Event.orderedCompareStartTime);\n      }\n    }\n    return events;\n  }\n\n  private static nameAuctionWorklet(workletType: WorkletType, url: Platform.DevToolsPath.UrlString|null): string {\n    switch (workletType) {\n      case WorkletType.BidderWorklet:\n        return url ? i18nString(UIStrings.bidderWorkletS, {PH1: url}) : i18nString(UIStrings.bidderWorklet);\n\n      case WorkletType.SellerWorklet:\n        return url ? i18nString(UIStrings.sellerWorkletS, {PH1: url}) : i18nString(UIStrings.sellerWorklet);\n\n      default:\n        return url ? i18nString(UIStrings.unknownWorkletS, {PH1: url}) : i18nString(UIStrings.unknownWorklet);\n    }\n  }\n\n  private processThreadEvents(\n      tracingModel: SDK.TracingModel.TracingModel, thread: SDK.TracingModel.Thread, isMainThread: boolean,\n      isWorker: boolean, forMainFrame: boolean, workletType: WorkletType,\n      url: Platform.DevToolsPath.UrlString|null): void {\n    const track = new Track();\n    track.name = thread.name() || i18nString(UIStrings.threadS, {PH1: thread.id()});\n    track.type = TrackType.Other;\n    track.thread = thread;\n    if (isMainThread) {\n      track.type = TrackType.MainThread;\n      track.url = url || Platform.DevToolsPath.EmptyUrlString;\n      track.forMainFrame = forMainFrame;\n    } else if (isWorker) {\n      track.type = TrackType.Worker;\n      track.url = url || Platform.DevToolsPath.EmptyUrlString;\n      track.name = track.url ? i18nString(UIStrings.workerS, {PH1: track.url}) : i18nString(UIStrings.dedicatedWorker);\n    } else if (thread.name().startsWith('CompositorTileWorker')) {\n      track.type = TrackType.Raster;\n    } else if (thread.name() === TimelineModelImpl.AuctionWorkletThreadName) {\n      track.url = url || Platform.DevToolsPath.EmptyUrlString;\n      track.name = TimelineModelImpl.nameAuctionWorklet(workletType, url);\n    } else if (\n        workletType !== WorkletType.NotWorklet &&\n        thread.name().endsWith(TimelineModelImpl.UtilityMainThreadNameSuffix)) {\n      track.url = url || Platform.DevToolsPath.EmptyUrlString;\n      track.name = url ? i18nString(UIStrings.workletServiceS, {PH1: url}) : i18nString(UIStrings.workletService);\n    }\n    this.tracksInternal.push(track);\n\n    const events = this.injectJSFrameEvents(tracingModel, thread);\n    this.eventStack = [];\n    const eventStack = this.eventStack;\n\n    // Get the worker name from the target.\n    if (isWorker) {\n      const cpuProfileEvent = events.find(event => event.name === RecordType.Profile);\n      if (cpuProfileEvent) {\n        const target = this.targetByEvent(cpuProfileEvent);\n        if (target) {\n          track.name = i18nString(UIStrings.workerSS, {PH1: target.name(), PH2: track.url});\n        }\n      }\n    }\n\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n\n      // There may be several TTI events, only take the first one.\n      if (this.isInteractiveTimeEvent(event) && this.totalBlockingTimeInternal === -1) {\n        this.totalBlockingTimeInternal = event.args['args']['total_blocking_time_ms'];\n      }\n\n      const isLongRunningTask = event.name === RecordType.Task && event.duration && event.duration > 50;\n      if (isMainThread && isLongRunningTask && event.duration) {\n        // We only track main thread events that are over 50ms, and the amount of time in the\n        // event (over 50ms) is what constitutes the blocking time. An event of 70ms, therefore,\n        // contributes 20ms to TBT.\n        this.estimatedTotalBlockingTime += event.duration - 50;\n      }\n\n      let last: SDK.TracingModel.Event = eventStack[eventStack.length - 1];\n      while (last && last.endTime !== undefined && last.endTime <= event.startTime) {\n        eventStack.pop();\n        last = eventStack[eventStack.length - 1];\n      }\n      if (!this.processEvent(event)) {\n        continue;\n      }\n      if (!TraceEngine.Types.TraceEvents.isAsyncPhase(event.phase) && event.duration) {\n        if (eventStack.length) {\n          const parent = eventStack[eventStack.length - 1];\n          if (parent) {\n            parent.selfTime -= event.duration;\n            if (parent.selfTime < 0) {\n              this.fixNegativeDuration(parent, event);\n            }\n          }\n        }\n        event.selfTime = event.duration;\n        if (!eventStack.length) {\n          track.tasks.push(event);\n        }\n        eventStack.push(event);\n      }\n      if (this.isMarkerEvent(event)) {\n        this.timeMarkerEventsInternal.push(event);\n      }\n\n      track.events.push(event);\n      this.inspectedTargetEventsInternal.push(event);\n    }\n\n    this.processAsyncEvents(thread);\n  }\n\n  private fixNegativeDuration(event: SDK.TracingModel.Event, child: SDK.TracingModel.Event): void {\n    const epsilon = 1e-3;\n    if (event.selfTime < -epsilon) {\n      console.error(\n          `Children are longer than parent at ${event.startTime} ` +\n          `(${(child.startTime - this.minimumRecordTime()).toFixed(3)} by ${(-event.selfTime).toFixed(3)}`);\n    }\n    event.selfTime = 0;\n  }\n\n  private processAsyncEvents(thread: SDK.TracingModel.Thread): void {\n    const asyncEvents = thread.asyncEvents();\n    const groups = new Map<TrackType, SDK.TracingModel.AsyncEvent[]>();\n\n    function group(type: TrackType): SDK.TracingModel.AsyncEvent[] {\n      if (!groups.has(type)) {\n        groups.set(type, []);\n      }\n      return groups.get(type) as SDK.TracingModel.AsyncEvent[];\n    }\n\n    for (let i = 0; i < asyncEvents.length; ++i) {\n      const asyncEvent = asyncEvents[i];\n\n      if (asyncEvent.name === RecordType.Animation) {\n        group(TrackType.Animation).push(asyncEvent);\n        continue;\n      }\n    }\n\n    for (const [type, events] of groups) {\n      const track = this.ensureNamedTrack(type);\n      track.thread = thread;\n      track.asyncEvents =\n          Platform.ArrayUtilities.mergeOrdered(track.asyncEvents, events, SDK.TracingModel.Event.compareStartTime);\n    }\n  }\n\n  private processEvent(event: SDK.TracingModel.Event): boolean {\n    const eventStack = this.eventStack;\n\n    if (!eventStack.length) {\n      if (this.currentTaskLayoutAndRecalcEvents && this.currentTaskLayoutAndRecalcEvents.length) {\n        const totalTime = this.currentTaskLayoutAndRecalcEvents.reduce((time, event) => {\n          return event.duration === undefined ? time : time + event.duration;\n        }, 0);\n        if (totalTime > TimelineModelImpl.Thresholds.ForcedLayout) {\n          for (const e of this.currentTaskLayoutAndRecalcEvents) {\n            const timelineData = EventOnTimelineData.forEvent(e);\n            timelineData.warning = e.name === RecordType.Layout ? TimelineModelImpl.WarningType.ForcedLayout :\n                                                                  TimelineModelImpl.WarningType.ForcedStyle;\n          }\n        }\n      }\n      this.currentTaskLayoutAndRecalcEvents = [];\n    }\n\n    if (this.currentScriptEvent) {\n      if (this.currentScriptEvent.endTime !== undefined && event.startTime > this.currentScriptEvent.endTime) {\n        this.currentScriptEvent = null;\n      }\n    }\n\n    const eventData = event.args['data'] || event.args['beginData'] || {};\n    const timelineData = EventOnTimelineData.forEvent(event);\n    if (eventData['stackTrace']) {\n      timelineData.stackTrace = eventData['stackTrace'].map((callFrameOrProfileNode: Protocol.Runtime.CallFrame) => {\n        // `callFrameOrProfileNode` can also be a `SDK.ProfileTreeModel.ProfileNode` for JSSample; that class\n        // has accessors to mimic a `CallFrame`, but apparently we don't adjust stack traces in that case. Whether\n        // we should is unclear.\n        if (event.name !== RecordType.JSSample && event.name !== RecordType.JSSystemSample &&\n            event.name !== RecordType.JSIdleSample) {\n          // We need to copy the data so we can safely modify it below.\n          const frame = {...callFrameOrProfileNode};\n          // TraceEvents come with 1-based line & column numbers. The frontend code\n          // requires 0-based ones. Adjust the values.\n          --frame.lineNumber;\n          --frame.columnNumber;\n          return frame;\n        }\n        return callFrameOrProfileNode;\n      });\n    }\n    let pageFrameId = TimelineModelImpl.eventFrameId(event);\n    const last = eventStack[eventStack.length - 1];\n    if (!pageFrameId && last) {\n      pageFrameId = EventOnTimelineData.forEvent(last).frameId;\n    }\n    timelineData.frameId = pageFrameId || (this.mainFrame && this.mainFrame.frameId) || '';\n    this.asyncEventTracker.processEvent(event);\n\n    switch (event.name) {\n      case RecordType.ResourceSendRequest:\n      case RecordType.WebSocketCreate: {\n        timelineData.setInitiator(eventStack[eventStack.length - 1] || null);\n        timelineData.url = eventData['url'];\n        break;\n      }\n\n      case RecordType.ScheduleStyleRecalculation: {\n        this.lastScheduleStyleRecalculation[eventData['frame']] = event;\n        break;\n      }\n\n      case RecordType.UpdateLayoutTree:\n      case RecordType.RecalculateStyles: {\n        this.invalidationTracker.didRecalcStyle(event);\n        if (event.args['beginData']) {\n          timelineData.setInitiator(this.lastScheduleStyleRecalculation[event.args['beginData']['frame']]);\n        }\n        this.lastRecalculateStylesEvent = event;\n        if (this.currentScriptEvent) {\n          this.currentTaskLayoutAndRecalcEvents.push(event);\n        }\n        break;\n      }\n\n      case RecordType.ScheduleStyleInvalidationTracking:\n      case RecordType.StyleRecalcInvalidationTracking:\n      case RecordType.StyleInvalidatorInvalidationTracking:\n      case RecordType.LayoutInvalidationTracking: {\n        this.invalidationTracker.addInvalidation(new InvalidationTrackingEvent(event, timelineData));\n        break;\n      }\n\n      case RecordType.InvalidateLayout: {\n        // Consider style recalculation as a reason for layout invalidation,\n        // but only if we had no earlier layout invalidation records.\n        let layoutInitator: (SDK.TracingModel.Event|null)|SDK.TracingModel.Event = event;\n        const frameId = eventData['frame'];\n        if (!this.layoutInvalidate[frameId] && this.lastRecalculateStylesEvent &&\n            this.lastRecalculateStylesEvent.endTime !== undefined &&\n            this.lastRecalculateStylesEvent.endTime > event.startTime) {\n          layoutInitator = EventOnTimelineData.forEvent(this.lastRecalculateStylesEvent).initiator();\n        }\n        this.layoutInvalidate[frameId] = layoutInitator;\n        break;\n      }\n\n      case RecordType.Layout: {\n        this.invalidationTracker.didLayout(event);\n        const frameId = event.args['beginData']['frame'];\n        timelineData.setInitiator(this.layoutInvalidate[frameId]);\n        // In case we have no closing Layout event, endData is not available.\n        if (event.args['endData']) {\n          if (event.args['endData']['layoutRoots']) {\n            for (let i = 0; i < event.args['endData']['layoutRoots'].length; ++i) {\n              timelineData.backendNodeIds.push(event.args['endData']['layoutRoots'][i]['nodeId']);\n            }\n          } else {\n            timelineData.backendNodeIds.push(event.args['endData']['rootNode']);\n          }\n        }\n        this.layoutInvalidate[frameId] = null;\n        if (this.currentScriptEvent) {\n          this.currentTaskLayoutAndRecalcEvents.push(event);\n        }\n        break;\n      }\n\n      case RecordType.Task: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.LongTask) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongTask;\n        }\n        break;\n      }\n\n      case RecordType.EventDispatch: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.RecurringHandler) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongHandler;\n        }\n        break;\n      }\n\n      case RecordType.TimerFire:\n      case RecordType.FireAnimationFrame: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.RecurringHandler) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongRecurringHandler;\n        }\n        break;\n      }\n      // @ts-ignore fallthrough intended.\n      case RecordType.FunctionCall: {\n        // Compatibility with old format.\n        if (typeof eventData['scriptName'] === 'string') {\n          eventData['url'] = eventData['scriptName'];\n        }\n        if (typeof eventData['scriptLine'] === 'number') {\n          eventData['lineNumber'] = eventData['scriptLine'];\n        }\n      }\n\n      case RecordType.EvaluateScript:\n      case RecordType.CompileScript:\n      // @ts-ignore fallthrough intended.\n      case RecordType.CacheScript: {\n        if (typeof eventData['lineNumber'] === 'number') {\n          --eventData['lineNumber'];\n        }\n        if (typeof eventData['columnNumber'] === 'number') {\n          --eventData['columnNumber'];\n        }\n      }\n\n      case RecordType.RunMicrotasks: {\n        // Microtasks technically are not necessarily scripts, but for purpose of\n        // forced sync style recalc or layout detection they are.\n        if (!this.currentScriptEvent) {\n          this.currentScriptEvent = event;\n        }\n        break;\n      }\n\n      case RecordType.SetLayerTreeId: {\n        // This is to support old traces.\n        if (this.sessionId && eventData['sessionId'] && this.sessionId === eventData['sessionId']) {\n          this.mainFrameLayerTreeId = eventData['layerTreeId'];\n          break;\n        }\n\n        // We currently only show layer tree for the main frame.\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        const pageFrame = frameId ? this.pageFrames.get(frameId) : null;\n        if (!pageFrame || pageFrame.parent) {\n          return false;\n        }\n        this.mainFrameLayerTreeId = eventData['layerTreeId'];\n        break;\n      }\n\n      case RecordType.Paint: {\n        this.invalidationTracker.didPaint = true;\n        // With CompositeAfterPaint enabled, paint events are no longer\n        // associated with a Node, and nodeId will not be present.\n        if ('nodeId' in eventData) {\n          timelineData.backendNodeIds.push(eventData['nodeId']);\n        }\n        // Only keep layer paint events, skip paints for subframes that get painted to the same layer as parent.\n        if (!eventData['layerId']) {\n          break;\n        }\n        const layerId = eventData['layerId'];\n        this.lastPaintForLayer[layerId] = event;\n        break;\n      }\n\n      case RecordType.DisplayItemListSnapshot:\n      case RecordType.PictureSnapshot: {\n        // If we get a snapshot, we try to find the last Paint event for the\n        // current layer, and store the snapshot as the relevant picture for\n        // that event, thus creating a relationship between the snapshot and\n        // the last Paint event for the current timestamp.\n        const layerUpdateEvent = this.findAncestorEvent(RecordType.UpdateLayer);\n        if (!layerUpdateEvent || layerUpdateEvent.args['layerTreeId'] !== this.mainFrameLayerTreeId) {\n          break;\n        }\n        const paintEvent = this.lastPaintForLayer[layerUpdateEvent.args['layerId']];\n        if (paintEvent) {\n          EventOnTimelineData.forEvent(paintEvent).picture = (event as SDK.TracingModel.ObjectSnapshot);\n        }\n        break;\n      }\n\n      case RecordType.ScrollLayer: {\n        timelineData.backendNodeIds.push(eventData['nodeId']);\n        break;\n      }\n\n      case RecordType.PaintImage: {\n        timelineData.backendNodeIds.push(eventData['nodeId']);\n        timelineData.url = eventData['url'];\n        break;\n      }\n\n      case RecordType.DecodeImage:\n      case RecordType.ResizeImage: {\n        let paintImageEvent = this.findAncestorEvent(RecordType.PaintImage);\n        if (!paintImageEvent) {\n          const decodeLazyPixelRefEvent = this.findAncestorEvent(RecordType.DecodeLazyPixelRef);\n          paintImageEvent =\n              decodeLazyPixelRefEvent && this.paintImageEventByPixelRefId[decodeLazyPixelRefEvent.args['LazyPixelRef']];\n        }\n        if (!paintImageEvent) {\n          break;\n        }\n        const paintImageData = EventOnTimelineData.forEvent(paintImageEvent);\n        timelineData.backendNodeIds.push(paintImageData.backendNodeIds[0]);\n        timelineData.url = paintImageData.url;\n        break;\n      }\n\n      case RecordType.DrawLazyPixelRef: {\n        const paintImageEvent = this.findAncestorEvent(RecordType.PaintImage);\n        if (!paintImageEvent) {\n          break;\n        }\n        this.paintImageEventByPixelRefId[event.args['LazyPixelRef']] = paintImageEvent;\n        const paintImageData = EventOnTimelineData.forEvent(paintImageEvent);\n        timelineData.backendNodeIds.push(paintImageData.backendNodeIds[0]);\n        timelineData.url = paintImageData.url;\n        break;\n      }\n\n      case RecordType.FrameStartedLoading: {\n        if (timelineData.frameId !== event.args['frame']) {\n          return false;\n        }\n        break;\n      }\n\n      case RecordType.MarkLCPCandidate: {\n        timelineData.backendNodeIds.push(eventData['nodeId']);\n        break;\n      }\n\n      case RecordType.MarkDOMContent:\n      case RecordType.MarkLoad: {\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        if (!frameId || !this.pageFrames.has(frameId)) {\n          return false;\n        }\n        break;\n      }\n\n      case RecordType.CommitLoad: {\n        if (this.browserFrameTracking) {\n          break;\n        }\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        const isOutermostMainFrame = Boolean(eventData['isOutermostMainFrame'] ?? eventData['isMainFrame']);\n        const pageFrame = frameId ? this.pageFrames.get(frameId) : null;\n        if (pageFrame) {\n          pageFrame.update(event.startTime, eventData);\n        } else {\n          // We should only have one main frame which has persistent id,\n          // unless it's an old trace without 'persistentIds' flag.\n          if (!this.persistentIds) {\n            if (eventData['page'] && eventData['page'] !== this.legacyCurrentPage) {\n              return false;\n            }\n          } else if (isOutermostMainFrame) {\n            return false;\n          } else if (!this.addPageFrame(event, eventData)) {\n            return false;\n          }\n        }\n        if (isOutermostMainFrame && frameId) {\n          const frame = this.pageFrames.get(frameId);\n          if (frame) {\n            this.mainFrame = frame;\n          }\n        }\n        break;\n      }\n\n      case RecordType.FireIdleCallback: {\n        if (event.duration !== undefined &&\n            event.duration > eventData['allottedMilliseconds'] + TimelineModelImpl.Thresholds.IdleCallbackAddon) {\n          timelineData.warning = TimelineModelImpl.WarningType.IdleDeadlineExceeded;\n        }\n        break;\n      }\n    }\n    return true;\n  }\n\n  private processBrowserEvent(event: SDK.TracingModel.Event): void {\n    if (event.name === RecordType.ResourceWillSendRequest) {\n      const requestId = event.args?.data?.requestId;\n      if (typeof requestId === 'string') {\n        this.requestsFromBrowser.set(requestId, event);\n      }\n      return;\n    }\n\n    if (event.hasCategory(SDK.TracingModel.DevToolsMetadataEventCategory) && event.args['data']) {\n      const data = event.args['data'];\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInBrowser) {\n        if (!data['persistentIds']) {\n          return;\n        }\n        this.browserFrameTracking = true;\n        this.mainFrameNodeId = data['frameTreeNodeId'];\n        const frames: any[] = data['frames'] || [];\n        frames.forEach(payload => {\n          const parent = payload['parent'] && this.pageFrames.get(payload['parent']);\n          if (payload['parent'] && !parent) {\n            return;\n          }\n          let frame = this.pageFrames.get(payload['frame']);\n          if (!frame) {\n            frame = new PageFrame(payload);\n            this.pageFrames.set(frame.frameId, frame);\n            if (parent) {\n              parent.addChild(frame);\n            } else {\n              this.mainFrame = frame;\n            }\n          }\n          // TODO(dgozman): this should use event.startTime, but due to races between tracing start\n          // in different processes we cannot do this yet.\n          frame.update(this.minimumRecordTimeInternal, payload);\n        });\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.FrameCommittedInBrowser && this.browserFrameTracking) {\n        let frame = this.pageFrames.get(data['frame']);\n        if (!frame) {\n          const parent = data['parent'] && this.pageFrames.get(data['parent']);\n          if (!parent) {\n            return;\n          }\n          frame = new PageFrame(data);\n          this.pageFrames.set(frame.frameId, frame);\n          parent.addChild(frame);\n        }\n        frame.update(event.startTime, data);\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.ProcessReadyInBrowser && this.browserFrameTracking) {\n        const frame = this.pageFrames.get(data['frame']);\n        if (frame) {\n          frame.processReady(data['processPseudoId'], data['processId']);\n        }\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.FrameDeletedInBrowser && this.browserFrameTracking) {\n        const frame = this.pageFrames.get(data['frame']);\n        if (frame) {\n          frame.deletedTime = event.startTime;\n        }\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.AuctionWorkletRunningInProcess &&\n          this.browserFrameTracking) {\n        const worklet = new AuctionWorklet(event, data);\n        this.auctionWorklets.set(data['target'], worklet);\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.AuctionWorkletDoneWithProcess &&\n          this.browserFrameTracking) {\n        const worklet = this.auctionWorklets.get(data['target']);\n        if (worklet) {\n          worklet.endTime = event.startTime;\n        }\n      }\n    }\n  }\n\n  private ensureNamedTrack(type: TrackType): Track {\n    let track = this.namedTracks.get(type);\n    if (track) {\n      return track;\n    }\n\n    track = new Track();\n    track.type = type;\n    this.tracksInternal.push(track);\n    this.namedTracks.set(type, track);\n    return track;\n  }\n\n  private findAncestorEvent(name: string): SDK.TracingModel.Event|null {\n    for (let i = this.eventStack.length - 1; i >= 0; --i) {\n      const event = this.eventStack[i];\n      if (event.name === name) {\n        return event;\n      }\n    }\n    return null;\n  }\n\n  private addPageFrame(event: SDK.TracingModel.Event, payload: any): boolean {\n    const parent = payload['parent'] && this.pageFrames.get(payload['parent']);\n    if (payload['parent'] && !parent) {\n      return false;\n    }\n    const pageFrame = new PageFrame(payload);\n    this.pageFrames.set(pageFrame.frameId, pageFrame);\n    pageFrame.update(event.startTime, payload);\n    if (parent) {\n      parent.addChild(pageFrame);\n    }\n    return true;\n  }\n\n  private reset(): void {\n    this.isGenericTraceInternal = false;\n    this.tracksInternal = [];\n    this.namedTracks = new Map();\n    this.inspectedTargetEventsInternal = [];\n    this.timeMarkerEventsInternal = [];\n    this.sessionId = null;\n    this.mainFrameNodeId = null;\n    this.cpuProfilesInternal = [];\n    this.workerIdByThread = new WeakMap();\n    this.pageFrames = new Map();\n    this.auctionWorklets = new Map();\n    this.requestsFromBrowser = new Map();\n\n    this.minimumRecordTimeInternal = 0;\n    this.maximumRecordTimeInternal = 0;\n\n    this.totalBlockingTimeInternal = -1;\n    this.estimatedTotalBlockingTime = 0;\n  }\n\n  isGenericTrace(): boolean {\n    return this.isGenericTraceInternal;\n  }\n\n  tracingModel(): SDK.TracingModel.TracingModel|null {\n    return this.tracingModelInternal;\n  }\n\n  minimumRecordTime(): number {\n    return this.minimumRecordTimeInternal;\n  }\n\n  maximumRecordTime(): number {\n    return this.maximumRecordTimeInternal;\n  }\n\n  inspectedTargetEvents(): SDK.TracingModel.Event[] {\n    return this.inspectedTargetEventsInternal;\n  }\n\n  tracks(): Track[] {\n    return this.tracksInternal;\n  }\n\n  isEmpty(): boolean {\n    return this.minimumRecordTime() === 0 && this.maximumRecordTime() === 0;\n  }\n\n  timeMarkerEvents(): SDK.TracingModel.Event[] {\n    return this.timeMarkerEventsInternal;\n  }\n\n  rootFrames(): PageFrame[] {\n    return Array.from(this.pageFrames.values()).filter(frame => !frame.parent);\n  }\n\n  pageURL(): Platform.DevToolsPath.UrlString {\n    return this.mainFrame && this.mainFrame.url || Platform.DevToolsPath.EmptyUrlString;\n  }\n\n  pageFrameById(frameId: Protocol.Page.FrameId): PageFrame|null {\n    return frameId ? this.pageFrames.get(frameId) || null : null;\n  }\n\n  networkRequests(): NetworkRequest[] {\n    if (this.isGenericTrace()) {\n      return [];\n    }\n    const requests = new Map<string, NetworkRequest>();\n    const requestsList: NetworkRequest[] = [];\n    const zeroStartRequestsList: NetworkRequest[] = [];\n    const resourceTypes = new Set<string>([\n      RecordType.ResourceWillSendRequest,\n      RecordType.ResourceSendRequest,\n      RecordType.ResourceReceiveResponse,\n      RecordType.ResourceReceivedData,\n      RecordType.ResourceFinish,\n      RecordType.ResourceMarkAsCached,\n    ]);\n    const events = this.inspectedTargetEvents();\n    for (let i = 0; i < events.length; ++i) {\n      const e = events[i];\n      if (!resourceTypes.has(e.name)) {\n        continue;\n      }\n      const id = TimelineModelImpl.globalEventId(e, 'requestId');\n      const requestId = e.args?.data?.requestId;\n      if (e.name === RecordType.ResourceSendRequest && requestId && this.requestsFromBrowser.has(requestId)) {\n        const event = this.requestsFromBrowser.get(requestId);\n        if (event) {\n          addRequest(event, id);\n        }\n      }\n      addRequest(e, id);\n    }\n    function addRequest(e: SDK.TracingModel.Event, id: string): void {\n      let request = requests.get(id);\n      if (request) {\n        request.addEvent(e);\n      } else {\n        request = new NetworkRequest(e);\n        requests.set(id, request);\n        if (request.startTime) {\n          requestsList.push(request);\n        } else {\n          zeroStartRequestsList.push(request);\n        }\n      }\n    }\n    return zeroStartRequestsList.concat(requestsList);\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum RecordType {\n  Task = 'RunTask',\n  Program = 'Program',\n  EventDispatch = 'EventDispatch',\n\n  GPUTask = 'GPUTask',\n\n  Animation = 'Animation',\n  RequestMainThreadFrame = 'RequestMainThreadFrame',\n  BeginFrame = 'BeginFrame',\n  NeedsBeginFrameChanged = 'NeedsBeginFrameChanged',\n  BeginMainThreadFrame = 'BeginMainThreadFrame',\n  ActivateLayerTree = 'ActivateLayerTree',\n  DrawFrame = 'DrawFrame',\n  DroppedFrame = 'DroppedFrame',\n  HitTest = 'HitTest',\n  ScheduleStyleRecalculation = 'ScheduleStyleRecalculation',\n  RecalculateStyles = 'RecalculateStyles',\n  UpdateLayoutTree = 'UpdateLayoutTree',\n  InvalidateLayout = 'InvalidateLayout',\n  Layerize = 'Layerize',\n  Layout = 'Layout',\n  LayoutShift = 'LayoutShift',\n  UpdateLayer = 'UpdateLayer',\n  UpdateLayerTree = 'UpdateLayerTree',\n  PaintSetup = 'PaintSetup',\n  Paint = 'Paint',\n  PaintImage = 'PaintImage',\n  PrePaint = 'PrePaint',\n  Rasterize = 'Rasterize',\n  RasterTask = 'RasterTask',\n  ScrollLayer = 'ScrollLayer',\n  Commit = 'Commit',\n  CompositeLayers = 'CompositeLayers',\n  ComputeIntersections = 'IntersectionObserverController::computeIntersections',\n  InteractiveTime = 'InteractiveTime',\n\n  ScheduleStyleInvalidationTracking = 'ScheduleStyleInvalidationTracking',\n  StyleRecalcInvalidationTracking = 'StyleRecalcInvalidationTracking',\n  StyleInvalidatorInvalidationTracking = 'StyleInvalidatorInvalidationTracking',\n  LayoutInvalidationTracking = 'LayoutInvalidationTracking',\n\n  ParseHTML = 'ParseHTML',\n  ParseAuthorStyleSheet = 'ParseAuthorStyleSheet',\n\n  TimerInstall = 'TimerInstall',\n  TimerRemove = 'TimerRemove',\n  TimerFire = 'TimerFire',\n\n  XHRReadyStateChange = 'XHRReadyStateChange',\n  XHRLoad = 'XHRLoad',\n  CompileScript = 'v8.compile',\n  CompileCode = 'V8.CompileCode',\n  OptimizeCode = 'V8.OptimizeCode',\n  EvaluateScript = 'EvaluateScript',\n  CacheScript = 'v8.produceCache',\n  CompileModule = 'v8.compileModule',\n  EvaluateModule = 'v8.evaluateModule',\n  CacheModule = 'v8.produceModuleCache',\n  WasmStreamFromResponseCallback = 'v8.wasm.streamFromResponseCallback',\n  WasmCompiledModule = 'v8.wasm.compiledModule',\n  WasmCachedModule = 'v8.wasm.cachedModule',\n  WasmModuleCacheHit = 'v8.wasm.moduleCacheHit',\n  WasmModuleCacheInvalid = 'v8.wasm.moduleCacheInvalid',\n\n  FrameStartedLoading = 'FrameStartedLoading',\n  CommitLoad = 'CommitLoad',\n  MarkLoad = 'MarkLoad',\n  MarkDOMContent = 'MarkDOMContent',\n  MarkFirstPaint = 'firstPaint',\n  MarkFCP = 'firstContentfulPaint',\n  MarkLCPCandidate = 'largestContentfulPaint::Candidate',\n  MarkLCPInvalidate = 'largestContentfulPaint::Invalidate',\n  NavigationStart = 'navigationStart',\n\n  TimeStamp = 'TimeStamp',\n  ConsoleTime = 'ConsoleTime',\n  UserTiming = 'UserTiming',\n  EventTiming = 'EventTiming',\n\n  ResourceWillSendRequest = 'ResourceWillSendRequest',\n  ResourceSendRequest = 'ResourceSendRequest',\n  ResourceReceiveResponse = 'ResourceReceiveResponse',\n  ResourceReceivedData = 'ResourceReceivedData',\n  ResourceFinish = 'ResourceFinish',\n  ResourceMarkAsCached = 'ResourceMarkAsCached',\n\n  RunMicrotasks = 'RunMicrotasks',\n  FunctionCall = 'FunctionCall',\n  GCEvent = 'GCEvent',\n  MajorGC = 'MajorGC',\n  MinorGC = 'MinorGC',\n\n  // The following types are used for CPUProfile.\n  // JSRoot is used for the root node.\n  // JSIdleFrame and JSIdleSample are used for idle nodes.\n  // JSSystemFrame and JSSystemSample are used for other system nodes.\n  // JSFrame and JSSample are used for other nodes, and will be categorized as |scripting|.\n  JSFrame = 'JSFrame',\n  JSSample = 'JSSample',\n  JSIdleFrame = 'JSIdleFrame',\n  JSIdleSample = 'JSIdleSample',\n  JSSystemFrame = 'JSSystemFrame',\n  JSSystemSample = 'JSSystemSample',\n  JSRoot = 'JSRoot',\n\n  // V8Sample events are coming from tracing and contain raw stacks with function addresses.\n  // After being processed with help of JitCodeAdded and JitCodeMoved events they\n  // get translated into function infos and stored as stacks in JSSample events.\n  V8Sample = 'V8Sample',\n  JitCodeAdded = 'JitCodeAdded',\n  JitCodeMoved = 'JitCodeMoved',\n  StreamingCompileScript = 'v8.parseOnBackground',\n  StreamingCompileScriptWaiting = 'v8.parseOnBackgroundWaiting',\n  StreamingCompileScriptParsing = 'v8.parseOnBackgroundParsing',\n  BackgroundDeserialize = 'v8.deserializeOnBackground',\n  FinalizeDeserialization = 'V8.FinalizeDeserialization',\n  V8Execute = 'V8.Execute',\n\n  UpdateCounters = 'UpdateCounters',\n\n  RequestAnimationFrame = 'RequestAnimationFrame',\n  CancelAnimationFrame = 'CancelAnimationFrame',\n  FireAnimationFrame = 'FireAnimationFrame',\n\n  RequestIdleCallback = 'RequestIdleCallback',\n  CancelIdleCallback = 'CancelIdleCallback',\n  FireIdleCallback = 'FireIdleCallback',\n\n  WebSocketCreate = 'WebSocketCreate',\n  WebSocketSendHandshakeRequest = 'WebSocketSendHandshakeRequest',\n  WebSocketReceiveHandshakeResponse = 'WebSocketReceiveHandshakeResponse',\n  WebSocketDestroy = 'WebSocketDestroy',\n\n  EmbedderCallback = 'EmbedderCallback',\n\n  SetLayerTreeId = 'SetLayerTreeId',\n  TracingStartedInPage = 'TracingStartedInPage',\n  TracingSessionIdForWorker = 'TracingSessionIdForWorker',\n  StartProfiling = 'CpuProfiler::StartProfiling',\n\n  DecodeImage = 'Decode Image',\n  ResizeImage = 'Resize Image',\n  DrawLazyPixelRef = 'Draw LazyPixelRef',\n  DecodeLazyPixelRef = 'Decode LazyPixelRef',\n\n  LazyPixelRef = 'LazyPixelRef',\n  LayerTreeHostImplSnapshot = 'cc::LayerTreeHostImpl',\n  PictureSnapshot = 'cc::Picture',\n  DisplayItemListSnapshot = 'cc::DisplayItemList',\n  InputLatencyMouseMove = 'InputLatency::MouseMove',\n  InputLatencyMouseWheel = 'InputLatency::MouseWheel',\n  ImplSideFling = 'InputHandlerProxy::HandleGestureFling::started',\n  GCCollectGarbage = 'BlinkGC.AtomicPhase',\n\n  CryptoDoEncrypt = 'DoEncrypt',\n  CryptoDoEncryptReply = 'DoEncryptReply',\n  CryptoDoDecrypt = 'DoDecrypt',\n  CryptoDoDecryptReply = 'DoDecryptReply',\n  CryptoDoDigest = 'DoDigest',\n  CryptoDoDigestReply = 'DoDigestReply',\n  CryptoDoSign = 'DoSign',\n  CryptoDoSignReply = 'DoSignReply',\n  CryptoDoVerify = 'DoVerify',\n  CryptoDoVerifyReply = 'DoVerifyReply',\n\n  // CpuProfile is a virtual event created on frontend to support\n  // serialization of CPU Profiles within tracing timeline data.\n  CpuProfile = 'CpuProfile',\n  Profile = 'Profile',\n\n  AsyncTask = 'AsyncTask',\n}\n\nexport namespace TimelineModelImpl {\n  export const Category = {\n    Console: 'blink.console',\n    UserTiming: 'blink.user_timing',\n    Loading: 'loading',\n  };\n\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n  // eslint-disable-next-line rulesdir/const_enum\n  export enum WarningType {\n    LongTask = 'LongTask',\n    ForcedStyle = 'ForcedStyle',\n    ForcedLayout = 'ForcedLayout',\n    IdleDeadlineExceeded = 'IdleDeadlineExceeded',\n    LongHandler = 'LongHandler',\n    LongRecurringHandler = 'LongRecurringHandler',\n    V8Deopt = 'V8Deopt',\n    LongInteraction = 'LongInteraction',\n  }\n\n  export const WorkerThreadName = 'DedicatedWorker thread';\n  export const WorkerThreadNameLegacy = 'DedicatedWorker Thread';\n  export const RendererMainThreadName = 'CrRendererMain';\n  export const BrowserMainThreadName = 'CrBrowserMain';\n  // The names of threads before M111 were exactly this, but afterwards have\n  // it a suffix after the exact role.\n  export const UtilityMainThreadNameSuffix = 'CrUtilityMain';\n  export const AuctionWorkletThreadName = 'AuctionV8HelperThread';\n\n  export const DevToolsMetadataEvent = {\n    TracingStartedInBrowser: 'TracingStartedInBrowser',\n    TracingStartedInPage: 'TracingStartedInPage',\n    TracingSessionIdForWorker: 'TracingSessionIdForWorker',\n    FrameCommittedInBrowser: 'FrameCommittedInBrowser',\n    ProcessReadyInBrowser: 'ProcessReadyInBrowser',\n    FrameDeletedInBrowser: 'FrameDeletedInBrowser',\n    AuctionWorkletRunningInProcess: 'AuctionWorkletRunningInProcess',\n    AuctionWorkletDoneWithProcess: 'AuctionWorkletDoneWithProcess',\n  };\n\n  export const Thresholds = {\n    LongTask: 50,\n    Handler: 150,\n    RecurringHandler: 50,\n    ForcedLayout: 30,\n    IdleCallbackAddon: 5,\n  };\n}\n\nexport class Track {\n  name: string;\n  type: TrackType;\n  forMainFrame: boolean;\n  url: Platform.DevToolsPath.UrlString;\n  /**\n   * For tracks that correspond to a thread in a trace, this field contains all the events in the\n   * thread (both sync and async). Other tracks (like Timings) only include events with instant\n   * (\"I\") or mark (\"R\") phases.\n   */\n  events: SDK.TracingModel.Event[];\n  /**\n   * For tracks that correspond to a thread in a trace, this field will be empty. Other tracks (like\n   * Interactions and Animations) have non-instant/mark events.\n   */\n  asyncEvents: SDK.TracingModel.AsyncEvent[];\n  tasks: SDK.TracingModel.Event[];\n  private eventsForTreeViewInternal: SDK.TracingModel.Event[]|null;\n  thread: SDK.TracingModel.Thread|null;\n  constructor() {\n    this.name = '';\n    this.type = TrackType.Other;\n    // TODO(dgozman): replace forMainFrame with a list of frames, urls and time ranges.\n    this.forMainFrame = false;\n    this.url = Platform.DevToolsPath.EmptyUrlString;\n    // TODO(dgozman): do not distinguish between sync and async events.\n    this.events = [];\n    this.asyncEvents = [];\n    this.tasks = [];\n    this.eventsForTreeViewInternal = null;\n    this.thread = null;\n  }\n\n  /**\n   * Gets trace events that can be organized in a tree structure. This\n   * is used for the tree views in the Bottom-up, Call tree and Event\n   * log view in the details pane.\n   *\n   * Depending on the type of track, this data can vary:\n   * 1. Tracks that correspond to a thread in a trace:\n   *    Returns all the events (sync and async). For these tracks, all\n   *    events will be inside the `events` field. Async events will be\n   *    filtered later when the trees are actually built. For these\n   *    tracks, the asyncEvents field will be empty.\n   *\n   * 2. Other tracks (Interactions, Timings, etc.):\n   *    Returns instant events (which for these tracks are stored in the\n   *    `events` field) and async events (contained in `syncEvents`) if\n   *    they can be organized in a tree structure. This latter condition\n   *    is met if there is *not* a pair of async events e1 and e2 where:\n   *\n   *    e1.startTime <= e2.startTime && e1.endTime > e2.startTime && e1.endTime > e2.endTime.\n   *    or, graphically:\n   *    |------- e1 ------|\n   *      |------- e2 --------|\n   *    Because async events are filtered later, fake sync events are\n   *    created from the async events when the condition above is met.\n   */\n  eventsForTreeView(): SDK.TracingModel.Event[] {\n    if (this.eventsForTreeViewInternal) {\n      return this.eventsForTreeViewInternal;\n    }\n\n    const stack: SDK.TracingModel.Event[] = [];\n\n    function peekLastEndTime(): number {\n      const last = stack[stack.length - 1];\n      if (last !== undefined) {\n        const endTime = last.endTime;\n        if (endTime !== undefined) {\n          return endTime;\n        }\n      }\n      throw new Error('End time does not exist on event.');\n    }\n\n    this.eventsForTreeViewInternal = [...this.events];\n    // Attempt to build a tree from async events, as if they where\n    // sync.\n    for (const event of this.asyncEvents) {\n      const startTime = event.startTime;\n      let endTime: number|(number | undefined) = event.endTime;\n      if (endTime === undefined) {\n        endTime = startTime;\n      }\n      // Look for a potential parent for this event:\n      // one whose end time is after this event start time.\n      while (stack.length && startTime >= peekLastEndTime()) {\n        stack.pop();\n      }\n      if (stack.length && endTime > peekLastEndTime()) {\n        // If such an event exists but its end time is before this\n        // event's end time (they cannot be nested), then a tree cannot\n        // be made from this track's async events. Return the sync\n        // events.\n        this.eventsForTreeViewInternal = [...this.events];\n        break;\n      }\n      const fakeSyncEvent = new SDK.TracingModel.ConstructedEvent(\n          event.categoriesString, event.name, TraceEngine.Types.TraceEvents.Phase.COMPLETE, startTime, event.thread);\n      fakeSyncEvent.setEndTime(endTime);\n      fakeSyncEvent.addArgs(event.args);\n      this.eventsForTreeViewInternal.push(fakeSyncEvent);\n      stack.push(fakeSyncEvent);\n    }\n    return this.eventsForTreeViewInternal;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum TrackType {\n  MainThread = 'MainThread',\n  Worker = 'Worker',\n  Animation = 'Animation',\n  Raster = 'Raster',\n  Experience = 'Experience',\n  Other = 'Other',\n}\n\nconst enum WorkletType {\n  NotWorklet = 0,\n  BidderWorklet = 1,\n  SellerWorklet = 2,\n  UnknownWorklet = 3,  // new type, or thread used for multiple ones.\n}\n\nexport class PageFrame {\n  frameId: any;\n  url: any;\n  name: any;\n  children: PageFrame[];\n  parent: PageFrame|null;\n  processes: {\n    time: number,\n    processId: number,\n    processPseudoId: string|null,\n    url: Platform.DevToolsPath.UrlString,\n  }[];\n  deletedTime: number|null;\n  ownerNode: SDK.DOMModel.DeferredDOMNode|null;\n  constructor(payload: any) {\n    this.frameId = payload['frame'];\n    this.url = payload['url'] || Platform.DevToolsPath.EmptyUrlString;\n    this.name = payload['name'];\n    this.children = [];\n    this.parent = null;\n    this.processes = [];\n    this.deletedTime = null;\n    // TODO(dgozman): figure this out.\n    // this.ownerNode = target && payload['nodeId'] ? new SDK.DOMModel.DeferredDOMNode(target, payload['nodeId']) : null;\n    this.ownerNode = null;\n  }\n\n  update(time: number, payload: any): void {\n    this.url = payload['url'] || '';\n    this.name = payload['name'];\n    if (payload['processId']) {\n      this.processes.push(\n          {time: time, processId: payload['processId'], processPseudoId: '', url: payload['url'] || ''});\n    } else {\n      this.processes.push(\n          {time: time, processId: -1, processPseudoId: payload['processPseudoId'], url: payload['url'] || ''});\n    }\n  }\n\n  processReady(processPseudoId: string, processId: number): void {\n    for (const process of this.processes) {\n      if (process.processPseudoId === processPseudoId) {\n        process.processPseudoId = '';\n        process.processId = processId;\n      }\n    }\n  }\n\n  addChild(child: PageFrame): void {\n    this.children.push(child);\n    child.parent = this;\n  }\n}\n\nexport class AuctionWorklet {\n  targetId: string;\n  processId: number;\n  host?: string;\n  startTime: number;\n  endTime: number;\n  workletType: WorkletType;\n  constructor(event: SDK.TracingModel.Event, data: any) {\n    this.targetId = (typeof data['target'] === 'string') ? data['target'] : '';\n    this.processId = (typeof data['pid'] === 'number') ? data['pid'] : 0;\n    this.host = (typeof data['host'] === 'string') ? data['host'] : undefined;\n    this.startTime = event.startTime;\n    this.endTime = Infinity;\n    if (data['type'] === 'bidder') {\n      this.workletType = WorkletType.BidderWorklet;\n    } else if (data['type'] === 'seller') {\n      this.workletType = WorkletType.SellerWorklet;\n    } else {\n      this.workletType = WorkletType.UnknownWorklet;\n    }\n  }\n}\n\nexport class NetworkRequest {\n  startTime: number;\n  endTime: number;\n  encodedDataLength: number;\n  decodedBodyLength: number;\n  children: SDK.TracingModel.Event[];\n  timing!: {\n    pushStart: number,\n    requestTime: number,\n    sendStart: number,\n    receiveHeadersEnd: number,\n  };\n  mimeType!: string;\n  url!: Platform.DevToolsPath.UrlString;\n  requestMethod!: string;\n  private transferSize: number;\n  private maybeDiskCached: boolean;\n  private memoryCachedInternal: boolean;\n  priority?: any;\n  finishTime?: number;\n  responseTime?: number;\n  fromServiceWorker?: boolean;\n  hasCachedResource?: boolean;\n  constructor(event: SDK.TracingModel.Event) {\n    const isInitial =\n        event.name === RecordType.ResourceSendRequest || event.name === RecordType.ResourceWillSendRequest;\n    this.startTime = isInitial ? event.startTime : 0;\n    this.endTime = Infinity;\n    this.encodedDataLength = 0;\n    this.decodedBodyLength = 0;\n    this.children = [];\n    this.transferSize = 0;\n    this.maybeDiskCached = false;\n    this.memoryCachedInternal = false;\n    this.addEvent(event);\n  }\n\n  addEvent(event: SDK.TracingModel.Event): void {\n    this.children.push(event);\n    // This Math.min is likely because of BUG(chromium:865066).\n    this.startTime = Math.min(this.startTime, event.startTime);\n    const eventData = event.args['data'];\n    if (eventData['mimeType']) {\n      this.mimeType = eventData['mimeType'];\n    }\n    if ('priority' in eventData) {\n      this.priority = eventData['priority'];\n    }\n    if (event.name === RecordType.ResourceFinish) {\n      this.endTime = event.startTime;\n    }\n    if (eventData['finishTime']) {\n      this.finishTime = eventData['finishTime'] * 1000;\n    }\n    if (!this.responseTime &&\n        (event.name === RecordType.ResourceReceiveResponse || event.name === RecordType.ResourceReceivedData)) {\n      this.responseTime = event.startTime;\n    }\n    const encodedDataLength = eventData['encodedDataLength'] || 0;\n    if (event.name === RecordType.ResourceMarkAsCached) {\n      // This is a reliable signal for memory caching.\n      this.memoryCachedInternal = true;\n    }\n    if (event.name === RecordType.ResourceReceiveResponse) {\n      if (eventData['fromCache']) {\n        // See BUG(chromium:998397): back-end over-approximates caching.\n        this.maybeDiskCached = true;\n      }\n      if (eventData['fromServiceWorker']) {\n        this.fromServiceWorker = true;\n      }\n      if (eventData['hasCachedResource']) {\n        this.hasCachedResource = true;\n      }\n      this.encodedDataLength = encodedDataLength;\n    }\n    if (event.name === RecordType.ResourceReceivedData) {\n      this.encodedDataLength += encodedDataLength;\n    }\n    if (event.name === RecordType.ResourceFinish && encodedDataLength) {\n      this.encodedDataLength = encodedDataLength;\n      // If a ResourceFinish event with an encoded data length is received,\n      // then the resource was not cached; it was fetched before it was\n      // requested, e.g. because it was pushed in this navigation.\n      this.transferSize = encodedDataLength;\n    }\n    const decodedBodyLength = eventData['decodedBodyLength'];\n    if (event.name === RecordType.ResourceFinish && decodedBodyLength) {\n      this.decodedBodyLength = decodedBodyLength;\n    }\n    if (!this.url) {\n      this.url = eventData['url'];\n    }\n    if (!this.requestMethod) {\n      this.requestMethod = eventData['requestMethod'];\n    }\n    if (!this.timing) {\n      this.timing = eventData['timing'];\n    }\n    if (eventData['fromServiceWorker']) {\n      this.fromServiceWorker = true;\n    }\n  }\n\n  /**\n   * Return whether this request was cached. This works around BUG(chromium:998397),\n   * which reports pushed resources, and resources serverd by a service worker as\n   * disk cached. Pushed resources that were not disk cached, however, have a non-zero\n   * `transferSize`.\n   */\n  cached(): boolean {\n    return Boolean(this.memoryCachedInternal) ||\n        (Boolean(this.maybeDiskCached) && !this.transferSize && !this.fromServiceWorker);\n  }\n\n  /**\n   * Return whether this request was served from a memory cache.\n   */\n  memoryCached(): boolean {\n    return this.memoryCachedInternal;\n  }\n\n  /**\n   * Get the timing information for this request. If the request was cached,\n   * the timing refers to the original (uncached) load, and should not be used.\n   */\n  getSendReceiveTiming(): {\n    sendStartTime: number,\n    headersEndTime: number,\n  } {\n    if (this.cached() || !this.timing) {\n      // If the request is served from cache, the timing refers to the original\n      // resource load, and should not be used.\n      return {sendStartTime: this.startTime, headersEndTime: this.startTime};\n    }\n    const requestTime = this.timing.requestTime * 1000;\n    const sendStartTime = requestTime + this.timing.sendStart;\n    const headersEndTime = requestTime + this.timing.receiveHeadersEnd;\n    return {sendStartTime, headersEndTime};\n  }\n\n  /**\n   * Get the start time of this request, i.e. the time when the browser or\n   * renderer queued this request. There are two cases where request time is\n   * earlier than `startTime`: (1) if the request is served from cache, because\n   * it refers to the original load of the resource. (2) if the request was\n   * initiated by the browser instead of the renderer. Only in case (2) the\n   * the request time must be used instead of the start time to work around\n   * BUG(chromium:865066).\n   */\n  getStartTime(): number {\n    return Math.min(this.startTime, !this.cached() && this.timing && this.timing.requestTime * 1000 || Infinity);\n  }\n\n  /**\n   * Returns the time where the earliest event belonging to this request starts.\n   * This differs from `getStartTime()` if a previous HTTP/2 request pushed the\n   * resource proactively: Then `beginTime()` refers to the time the push was received.\n   */\n  beginTime(): number {\n    // `pushStart` is referring to the original push if the request was cached (i.e. in\n    // general not the most recent push), and should hence only be used for requests that were not cached.\n    return Math.min(this.getStartTime(), !this.cached() && this.timing && this.timing.pushStart * 1000 || Infinity);\n  }\n}\n\nexport class InvalidationTrackingEvent {\n  type: string;\n  startTime: number;\n  readonly tracingEvent: SDK.TracingModel.Event;\n  frame: number;\n  nodeId: number|null;\n  nodeName: string|null;\n  invalidationSet: number|null;\n  invalidatedSelectorId: string|null;\n  changedId: string|null;\n  changedClass: string|null;\n  changedAttribute: string|null;\n  changedPseudo: string|null;\n  selectorPart: string|null;\n  extraData: string|null;\n  invalidationList: {\n    [x: string]: number,\n  }[]|null;\n  cause: InvalidationCause;\n  linkedRecalcStyleEvent: boolean;\n  linkedLayoutEvent: boolean;\n  constructor(event: SDK.TracingModel.Event, timelineData: EventOnTimelineData) {\n    this.type = event.name;\n    this.startTime = event.startTime;\n    this.tracingEvent = event;\n\n    const eventData = event.args['data'];\n\n    this.frame = eventData['frame'];\n    this.nodeId = eventData['nodeId'];\n    this.nodeName = eventData['nodeName'];\n    this.invalidationSet = eventData['invalidationSet'];\n    this.invalidatedSelectorId = eventData['invalidatedSelectorId'];\n    this.changedId = eventData['changedId'];\n    this.changedClass = eventData['changedClass'];\n    this.changedAttribute = eventData['changedAttribute'];\n    this.changedPseudo = eventData['changedPseudo'];\n    this.selectorPart = eventData['selectorPart'];\n    this.extraData = eventData['extraData'];\n    this.invalidationList = eventData['invalidationList'];\n    this.cause = {reason: eventData['reason'], stackTrace: timelineData.stackTrace};\n    this.linkedRecalcStyleEvent = false;\n    this.linkedLayoutEvent = false;\n\n    // FIXME: Move this to TimelineUIUtils.js.\n    if (!this.cause.reason && this.cause.stackTrace && this.type === RecordType.LayoutInvalidationTracking) {\n      this.cause.reason = 'Layout forced';\n    }\n  }\n}\n\nexport class InvalidationTracker {\n  private lastRecalcStyle: SDK.TracingModel.Event|null;\n  didPaint: boolean;\n  private invalidations: {\n    [x: string]: InvalidationTrackingEvent[],\n  };\n  private invalidationsByNodeId: {\n    [x: number]: InvalidationTrackingEvent[],\n  };\n  constructor() {\n    this.lastRecalcStyle = null;\n    this.didPaint = false;\n    this.initializePerFrameState();\n    this.invalidations = {};\n    this.invalidationsByNodeId = {};\n  }\n\n  static invalidationEventsFor(event: SDK.TracingModel.Event|\n                               TraceEngine.Types.TraceEvents.TraceEventData): InvalidationTrackingEvent[]|null {\n    return eventToInvalidation.get(event) || null;\n  }\n\n  addInvalidation(invalidation: InvalidationTrackingEvent): void {\n    this.startNewFrameIfNeeded();\n\n    if (!invalidation.nodeId) {\n      console.error('Invalidation lacks node information.');\n      console.error(invalidation);\n      return;\n    }\n\n    // Suppress StyleInvalidator StyleRecalcInvalidationTracking invalidations because they\n    // will be handled by StyleInvalidatorInvalidationTracking.\n    // FIXME: Investigate if we can remove StyleInvalidator invalidations entirely.\n    if (invalidation.type === RecordType.StyleRecalcInvalidationTracking &&\n        invalidation.cause.reason === 'StyleInvalidator') {\n      return;\n    }\n\n    // Style invalidation events can occur before and during recalc style. didRecalcStyle\n    // handles style invalidations that occur before the recalc style event but we need to\n    // handle style recalc invalidations during recalc style here.\n    const styleRecalcInvalidation =\n        (invalidation.type === RecordType.ScheduleStyleInvalidationTracking ||\n         invalidation.type === RecordType.StyleInvalidatorInvalidationTracking ||\n         invalidation.type === RecordType.StyleRecalcInvalidationTracking);\n    if (styleRecalcInvalidation) {\n      const duringRecalcStyle = invalidation.startTime && this.lastRecalcStyle &&\n          this.lastRecalcStyle.endTime !== undefined && invalidation.startTime >= this.lastRecalcStyle.startTime &&\n          invalidation.startTime <= this.lastRecalcStyle.endTime;\n      if (duringRecalcStyle) {\n        this.associateWithLastRecalcStyleEvent(invalidation);\n      }\n    }\n\n    // Record the invalidation so later events can look it up.\n    if (this.invalidations[invalidation.type]) {\n      this.invalidations[invalidation.type].push(invalidation);\n    } else {\n      this.invalidations[invalidation.type] = [invalidation];\n    }\n    if (invalidation.nodeId) {\n      if (this.invalidationsByNodeId[invalidation.nodeId]) {\n        this.invalidationsByNodeId[invalidation.nodeId].push(invalidation);\n      } else {\n        this.invalidationsByNodeId[invalidation.nodeId] = [invalidation];\n      }\n    }\n  }\n\n  didRecalcStyle(recalcStyleEvent: SDK.TracingModel.Event): void {\n    this.lastRecalcStyle = recalcStyleEvent;\n    const types = [\n      RecordType.ScheduleStyleInvalidationTracking,\n      RecordType.StyleInvalidatorInvalidationTracking,\n      RecordType.StyleRecalcInvalidationTracking,\n    ];\n    for (const invalidation of this.invalidationsOfTypes(types)) {\n      this.associateWithLastRecalcStyleEvent(invalidation);\n    }\n  }\n\n  private associateWithLastRecalcStyleEvent(invalidation: InvalidationTrackingEvent): void {\n    if (invalidation.linkedRecalcStyleEvent) {\n      return;\n    }\n\n    if (!this.lastRecalcStyle) {\n      throw new Error('Last recalculate style event not set.');\n    }\n    const recalcStyleFrameId = this.lastRecalcStyle.args['beginData']['frame'];\n    if (invalidation.type === RecordType.StyleInvalidatorInvalidationTracking) {\n      // Instead of calling addInvalidationToEvent directly, we create synthetic\n      // StyleRecalcInvalidationTracking events which will be added in addInvalidationToEvent.\n      this.addSyntheticStyleRecalcInvalidations(this.lastRecalcStyle, recalcStyleFrameId, invalidation);\n    } else if (invalidation.type === RecordType.ScheduleStyleInvalidationTracking) {\n      // ScheduleStyleInvalidationTracking events are only used for adding information to\n      // StyleInvalidatorInvalidationTracking events. See: addSyntheticStyleRecalcInvalidations.\n    } else {\n      this.addInvalidationToEvent(this.lastRecalcStyle, recalcStyleFrameId, invalidation);\n    }\n\n    invalidation.linkedRecalcStyleEvent = true;\n  }\n\n  private addSyntheticStyleRecalcInvalidations(\n      event: SDK.TracingModel.Event, frameId: number, styleInvalidatorInvalidation: InvalidationTrackingEvent): void {\n    if (!styleInvalidatorInvalidation.invalidationList) {\n      this.addSyntheticStyleRecalcInvalidation(styleInvalidatorInvalidation.tracingEvent, styleInvalidatorInvalidation);\n      return;\n    }\n    if (!styleInvalidatorInvalidation.nodeId) {\n      console.error('Invalidation lacks node information.');\n      console.error(styleInvalidatorInvalidation);\n      return;\n    }\n    for (let i = 0; i < styleInvalidatorInvalidation.invalidationList.length; i++) {\n      const setId = styleInvalidatorInvalidation.invalidationList[i]['id'];\n      let lastScheduleStyleRecalculation;\n      const nodeInvalidations = this.invalidationsByNodeId[styleInvalidatorInvalidation.nodeId] || [];\n      for (let j = 0; j < nodeInvalidations.length; j++) {\n        const invalidation = nodeInvalidations[j];\n        if (invalidation.frame !== frameId || invalidation.invalidationSet !== setId ||\n            invalidation.type !== RecordType.ScheduleStyleInvalidationTracking) {\n          continue;\n        }\n        lastScheduleStyleRecalculation = invalidation;\n      }\n      if (!lastScheduleStyleRecalculation) {\n        continue;\n      }\n      this.addSyntheticStyleRecalcInvalidation(\n          lastScheduleStyleRecalculation.tracingEvent, styleInvalidatorInvalidation);\n    }\n  }\n\n  private addSyntheticStyleRecalcInvalidation(\n      baseEvent: SDK.TracingModel.Event, styleInvalidatorInvalidation: InvalidationTrackingEvent): void {\n    const timelineData = EventOnTimelineData.forEvent(baseEvent);\n    const invalidation = new InvalidationTrackingEvent(baseEvent, timelineData);\n    invalidation.type = RecordType.StyleRecalcInvalidationTracking;\n    if (styleInvalidatorInvalidation.cause.reason) {\n      invalidation.cause.reason = styleInvalidatorInvalidation.cause.reason;\n    }\n    if (styleInvalidatorInvalidation.selectorPart) {\n      invalidation.selectorPart = styleInvalidatorInvalidation.selectorPart;\n    }\n\n    if (!invalidation.linkedRecalcStyleEvent) {\n      this.associateWithLastRecalcStyleEvent(invalidation);\n    }\n  }\n\n  didLayout(layoutEvent: SDK.TracingModel.Event): void {\n    const layoutFrameId = layoutEvent.args['beginData']['frame'];\n    for (const invalidation of this.invalidationsOfTypes([RecordType.LayoutInvalidationTracking])) {\n      if (invalidation.linkedLayoutEvent) {\n        continue;\n      }\n      this.addInvalidationToEvent(layoutEvent, layoutFrameId, invalidation);\n      invalidation.linkedLayoutEvent = true;\n    }\n  }\n\n  private addInvalidationToEvent(\n      event: SDK.TracingModel.Event, eventFrameId: number, invalidation: InvalidationTrackingEvent): void {\n    if (eventFrameId !== invalidation.frame) {\n      return;\n    }\n    const invalidations = eventToInvalidation.get(event);\n    if (!invalidations) {\n      eventToInvalidation.set(event, [invalidation]);\n    } else {\n      invalidations.push(invalidation);\n    }\n  }\n\n  private invalidationsOfTypes(types?: string[]): Generator<InvalidationTrackingEvent, any, any> {\n    const invalidations = this.invalidations;\n    if (!types) {\n      types = Object.keys(invalidations);\n    }\n    function* generator(): Generator<InvalidationTrackingEvent, void, unknown> {\n      if (!types) {\n        return;\n      }\n      for (let i = 0; i < types.length; ++i) {\n        const invalidationList = invalidations[types[i]] || [];\n        for (let j = 0; j < invalidationList.length; ++j) {\n          yield invalidationList[j];\n        }\n      }\n    }\n    return generator();\n  }\n\n  private startNewFrameIfNeeded(): void {\n    if (!this.didPaint) {\n      return;\n    }\n\n    this.initializePerFrameState();\n  }\n\n  private initializePerFrameState(): void {\n    this.invalidations = {};\n    this.invalidationsByNodeId = {};\n\n    this.lastRecalcStyle = null;\n    this.didPaint = false;\n  }\n}\n\nexport class TimelineAsyncEventTracker {\n  private readonly initiatorByType: Map<RecordType, Map<RecordType, SDK.TracingModel.Event>>;\n  constructor() {\n    TimelineAsyncEventTracker.initialize();\n    this.initiatorByType = new Map();\n    if (TimelineAsyncEventTracker.asyncEvents) {\n      for (const initiator of TimelineAsyncEventTracker.asyncEvents.keys()) {\n        this.initiatorByType.set(initiator, new Map());\n      }\n    }\n  }\n\n  private static initialize(): void {\n    if (TimelineAsyncEventTracker.asyncEvents) {\n      return;\n    }\n\n    const events = new Map<RecordType, {\n      causes: RecordType[],\n      joinBy: string,\n    }>();\n\n    events.set(RecordType.TimerInstall, {causes: [RecordType.TimerFire], joinBy: 'timerId'});\n    events.set(RecordType.ResourceSendRequest, {\n      causes: [\n        RecordType.ResourceMarkAsCached,\n        RecordType.ResourceReceiveResponse,\n        RecordType.ResourceReceivedData,\n        RecordType.ResourceFinish,\n      ],\n      joinBy: 'requestId',\n    });\n    events.set(RecordType.RequestAnimationFrame, {causes: [RecordType.FireAnimationFrame], joinBy: 'id'});\n    events.set(RecordType.RequestIdleCallback, {causes: [RecordType.FireIdleCallback], joinBy: 'id'});\n    events.set(RecordType.WebSocketCreate, {\n      causes: [\n        RecordType.WebSocketSendHandshakeRequest,\n        RecordType.WebSocketReceiveHandshakeResponse,\n        RecordType.WebSocketDestroy,\n      ],\n      joinBy: 'identifier',\n    });\n\n    TimelineAsyncEventTracker.asyncEvents = events;\n    TimelineAsyncEventTracker.typeToInitiator = new Map();\n    for (const entry of events) {\n      const types = entry[1].causes;\n      for (const currentType of types) {\n        TimelineAsyncEventTracker.typeToInitiator.set(currentType, entry[0]);\n      }\n    }\n  }\n\n  processEvent(event: SDK.TracingModel.Event): void {\n    if (!TimelineAsyncEventTracker.typeToInitiator || !TimelineAsyncEventTracker.asyncEvents) {\n      return;\n    }\n    let initiatorType: RecordType|undefined = TimelineAsyncEventTracker.typeToInitiator.get((event.name as RecordType));\n    const isInitiator = !initiatorType;\n    if (!initiatorType) {\n      initiatorType = (event.name as RecordType);\n    }\n    const initiatorInfo = TimelineAsyncEventTracker.asyncEvents.get(initiatorType);\n    if (!initiatorInfo) {\n      return;\n    }\n    const id = (TimelineModelImpl.globalEventId(event, initiatorInfo.joinBy) as RecordType);\n    if (!id) {\n      return;\n    }\n    const initiatorMap: Map<RecordType, SDK.TracingModel.Event>|undefined = this.initiatorByType.get(initiatorType);\n    if (initiatorMap) {\n      if (isInitiator) {\n        initiatorMap.set(id, event);\n        return;\n      }\n      const initiator = initiatorMap.get(id);\n      const timelineData = EventOnTimelineData.forEvent(event);\n      timelineData.setInitiator(initiator ? initiator : null);\n      if (!timelineData.frameId && initiator) {\n        timelineData.frameId = TimelineModelImpl.eventFrameId(initiator);\n      }\n    }\n  }\n\n  private static asyncEvents: Map<RecordType, {causes: RecordType[], joinBy: string}>|null = null;\n  private static typeToInitiator: Map<RecordType, RecordType>|null = null;\n}\n\nexport class EventOnTimelineData {\n  warning: string|null;\n  previewElement: Element|null;\n  url: Platform.DevToolsPath.UrlString|null;\n  backendNodeIds: Protocol.DOM.BackendNodeId[];\n  stackTrace: Protocol.Runtime.CallFrame[]|null;\n  picture: SDK.TracingModel.ObjectSnapshot|null;\n  private initiatorInternal: SDK.TracingModel.Event|null;\n  frameId: Protocol.Page.FrameId|null;\n  timeWaitingForMainThread?: number;\n\n  constructor() {\n    this.warning = null;\n    this.previewElement = null;\n    this.url = null;\n    this.backendNodeIds = [];\n    this.stackTrace = null;\n    this.picture = null;\n    this.initiatorInternal = null;\n    this.frameId = null;\n  }\n\n  setInitiator(initiator: SDK.TracingModel.Event|null): void {\n    this.initiatorInternal = initiator;\n    if (!initiator || this.url) {\n      return;\n    }\n    const initiatorURL = EventOnTimelineData.forEvent(initiator).url;\n    if (initiatorURL) {\n      this.url = initiatorURL;\n    }\n  }\n\n  initiator(): SDK.TracingModel.Event|null {\n    return this.initiatorInternal;\n  }\n\n  topFrame(): Protocol.Runtime.CallFrame|null {\n    const stackTrace = this.stackTraceForSelfOrInitiator();\n    return stackTrace && stackTrace[0] || null;\n  }\n\n  stackTraceForSelfOrInitiator(): Protocol.Runtime.CallFrame[]|null {\n    return this.stackTrace ||\n        (this.initiatorInternal && EventOnTimelineData.forEvent(this.initiatorInternal).stackTrace);\n  }\n\n  static forEvent(event: SDK.TracingModel.CompatibleTraceEvent): EventOnTimelineData {\n    if (event instanceof SDK.TracingModel.PayloadEvent) {\n      return EventOnTimelineData.forTraceEventData(event.rawPayload());\n    }\n    if (!(event instanceof SDK.TracingModel.Event)) {\n      return EventOnTimelineData.forTraceEventData(event);\n    }\n    return getOrCreateEventData(event);\n  }\n\n  static forTraceEventData(event: TraceEngine.Types.TraceEvents.TraceEventData): EventOnTimelineData {\n    return getOrCreateEventData(event);\n  }\n}\n\nfunction getOrCreateEventData(event: SDK.TracingModel.ConstructedEvent|\n                              TraceEngine.Types.TraceEvents.TraceEventData): EventOnTimelineData {\n  let data = eventToData.get(event);\n  if (!data) {\n    data = new EventOnTimelineData();\n    eventToData.set(event, data);\n  }\n  return data;\n}\n\nconst eventToData = new WeakMap<SDK.TracingModel.ConstructedEvent|TraceEngine.Types.TraceEvents.TraceEventData>();\nconst eventToInvalidation = new WeakMap();\nexport interface InvalidationCause {\n  reason: string;\n  stackTrace: Protocol.Runtime.CallFrame[]|null;\n}\nexport interface MetadataEvents {\n  page: SDK.TracingModel.Event[];\n  workers: SDK.TracingModel.Event[];\n}\n"]}