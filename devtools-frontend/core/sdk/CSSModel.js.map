{"version":3,"file":"CSSModel.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/CSSModel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2010 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the #name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport * as Common from '../common/common.js';\nimport * as Host from '../host/host.js';\nimport * as Platform from '../platform/platform.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport {CSSFontFace} from './CSSFontFace.js';\nimport {CSSMatchedStyles} from './CSSMatchedStyles.js';\nimport {CSSMedia} from './CSSMedia.js';\nimport {CSSStyleRule} from './CSSRule.js';\nimport {CSSStyleDeclaration, Type} from './CSSStyleDeclaration.js';\nimport {CSSStyleSheetHeader} from './CSSStyleSheetHeader.js';\nimport type {DOMNode} from './DOMModel.js';\nimport {DOMModel} from './DOMModel.js';\nimport {Events as ResourceTreeModelEvents, ResourceTreeModel} from './ResourceTreeModel.js';\nimport type {Target} from './Target.js';\nimport {Capability} from './Target.js';\nimport {SDKModel} from './SDKModel.js';\nimport {SourceMapManager} from './SourceMapManager.js';\n\nexport class CSSModel extends SDKModel<EventTypes> {\n  #isEnabledInternal: boolean;\n  #cachedMatchedCascadeNode: DOMNode|null;\n  #cachedMatchedCascadePromise: Promise<CSSMatchedStyles|null>|null;\n  readonly #domModelInternal: DOMModel;\n  readonly #sourceMapManagerInternal: SourceMapManager<CSSStyleSheetHeader>;\n  agent: ProtocolProxyApi.CSSApi;\n  readonly #styleLoader: ComputedStyleLoader;\n  readonly #resourceTreeModel: ResourceTreeModel|null;\n  #styleSheetIdToHeader: Map<Protocol.CSS.StyleSheetId, CSSStyleSheetHeader>;\n  readonly #styleSheetIdsForURL: Map<string, Map<string, Set<Protocol.CSS.StyleSheetId>>>;\n  readonly #originalStyleSheetTextInternal: Map<CSSStyleSheetHeader, Promise<string|null>>;\n  #isRuleUsageTrackingEnabled: boolean;\n  readonly #fontFacesInternal: Map<string, CSSFontFace>;\n  #cssPropertyTracker: CSSPropertyTracker|null;\n  #isCSSPropertyTrackingEnabled: boolean;\n  #isTrackingRequestPending: boolean;\n  readonly #trackedCSSProperties: Map<number, Protocol.CSS.CSSComputedStyleProperty[]>;\n  readonly #stylePollingThrottler: Common.Throttler.Throttler;\n\n  constructor(target: Target) {\n    super(target);\n    this.#isEnabledInternal = false;\n    this.#cachedMatchedCascadeNode = null;\n    this.#cachedMatchedCascadePromise = null;\n    this.#domModelInternal = (target.model(DOMModel) as DOMModel);\n    this.#sourceMapManagerInternal = new SourceMapManager(target);\n    this.agent = target.cssAgent();\n    this.#styleLoader = new ComputedStyleLoader(this);\n    this.#resourceTreeModel = target.model(ResourceTreeModel);\n    if (this.#resourceTreeModel) {\n      this.#resourceTreeModel.addEventListener(ResourceTreeModelEvents.MainFrameNavigated, this.resetStyleSheets, this);\n    }\n    target.registerCSSDispatcher(new CSSDispatcher(this));\n    if (!target.suspended()) {\n      this.enable();\n    }\n    this.#styleSheetIdToHeader = new Map();\n    this.#styleSheetIdsForURL = new Map();\n\n    this.#originalStyleSheetTextInternal = new Map();\n\n    this.#isRuleUsageTrackingEnabled = false;\n\n    this.#fontFacesInternal = new Map();\n\n    this.#cssPropertyTracker = null;  // TODO: support multiple trackers when we refactor the backend\n    this.#isCSSPropertyTrackingEnabled = false;\n    this.#isTrackingRequestPending = false;\n    this.#trackedCSSProperties = new Map();\n    this.#stylePollingThrottler = new Common.Throttler.Throttler(StylePollingInterval);\n\n    this.#sourceMapManagerInternal.setEnabled(\n        Common.Settings.Settings.instance().moduleSetting('cssSourceMapsEnabled').get());\n    Common.Settings.Settings.instance()\n        .moduleSetting('cssSourceMapsEnabled')\n        .addChangeListener(event => this.#sourceMapManagerInternal.setEnabled((event.data as boolean)));\n  }\n\n  headersForSourceURL(sourceURL: string): CSSStyleSheetHeader[] {\n    const headers = [];\n    for (const headerId of this.getStyleSheetIdsForURL(sourceURL)) {\n      const header = this.styleSheetHeaderForId(headerId);\n      if (header) {\n        headers.push(header);\n      }\n    }\n    return headers;\n  }\n\n  createRawLocationsByURL(sourceURL: string, lineNumber: number, columnNumber: number|undefined = 0): CSSLocation[] {\n    const headers = this.headersForSourceURL(sourceURL);\n    headers.sort(stylesheetComparator);\n    const endIndex = Platform.ArrayUtilities.upperBound(\n        headers, undefined, (_, header) => lineNumber - header.startLine || columnNumber - header.startColumn);\n    if (!endIndex) {\n      return [];\n    }\n    const locations = [];\n    const last = headers[endIndex - 1];\n    for (let index = endIndex - 1;\n         index >= 0 && headers[index].startLine === last.startLine && headers[index].startColumn === last.startColumn;\n         --index) {\n      if (headers[index].containsLocation(lineNumber, columnNumber)) {\n        locations.push(new CSSLocation(headers[index], lineNumber, columnNumber));\n      }\n    }\n\n    return locations;\n    function stylesheetComparator(a: CSSStyleSheetHeader, b: CSSStyleSheetHeader): number {\n      return a.startLine - b.startLine || a.startColumn - b.startColumn || a.id.localeCompare(b.id);\n    }\n  }\n\n  sourceMapManager(): SourceMapManager<CSSStyleSheetHeader> {\n    return this.#sourceMapManagerInternal;\n  }\n\n  static trimSourceURL(text: string): string {\n    let sourceURLIndex = text.lastIndexOf('/*# sourceURL=');\n    if (sourceURLIndex === -1) {\n      sourceURLIndex = text.lastIndexOf('/*@ sourceURL=');\n      if (sourceURLIndex === -1) {\n        return text;\n      }\n    }\n    const sourceURLLineIndex = text.lastIndexOf('\\n', sourceURLIndex);\n    if (sourceURLLineIndex === -1) {\n      return text;\n    }\n    const sourceURLLine = text.substr(sourceURLLineIndex + 1).split('\\n', 1)[0];\n    const sourceURLRegex = /[\\040\\t]*\\/\\*[#@] sourceURL=[\\040\\t]*([^\\s]*)[\\040\\t]*\\*\\/[\\040\\t]*$/;\n    if (sourceURLLine.search(sourceURLRegex) === -1) {\n      return text;\n    }\n    return text.substr(0, sourceURLLineIndex) + text.substr(sourceURLLineIndex + sourceURLLine.length + 1);\n  }\n\n  domModel(): DOMModel {\n    return this.#domModelInternal;\n  }\n\n  async setStyleText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string,\n      majorChange: boolean): Promise<boolean> {\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n\n      const {styles} = await this.agent.invoke_setStyleTexts(\n          {edits: [{styleSheetId: styleSheetId, range: range.serializeToObject(), text}]});\n      if (!styles || styles.length !== 1) {\n        return false;\n      }\n\n      this.#domModelInternal.markUndoableState(!majorChange);\n      const edit = new Edit(styleSheetId, range, text, styles[0]);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setSelectorText(styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string):\n      Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {selectorList} = await this.agent.invoke_setRuleSelector({styleSheetId, range, selector: text});\n\n      if (!selectorList) {\n        return false;\n      }\n      this.#domModelInternal.markUndoableState();\n      const edit = new Edit(styleSheetId, range, text, selectorList);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setKeyframeKey(styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string):\n      Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {keyText} = await this.agent.invoke_setKeyframeKey({styleSheetId, range, keyText: text});\n\n      if (!keyText) {\n        return false;\n      }\n      this.#domModelInternal.markUndoableState();\n      const edit = new Edit(styleSheetId, range, text, keyText);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  startCoverage(): Promise<Protocol.ProtocolResponseWithError> {\n    this.#isRuleUsageTrackingEnabled = true;\n    return this.agent.invoke_startRuleUsageTracking();\n  }\n\n  async takeCoverageDelta(): Promise<{\n    timestamp: number,\n    coverage: Array<Protocol.CSS.RuleUsage>,\n  }> {\n    const r = await this.agent.invoke_takeCoverageDelta();\n    const timestamp = (r && r.timestamp) || 0;\n    const coverage = (r && r.coverage) || [];\n    return {timestamp, coverage};\n  }\n\n  setLocalFontsEnabled(enabled: boolean): Promise<Protocol.ProtocolResponseWithError> {\n    return this.agent.invoke_setLocalFontsEnabled({\n      enabled,\n    });\n  }\n\n  async stopCoverage(): Promise<void> {\n    this.#isRuleUsageTrackingEnabled = false;\n    await this.agent.invoke_stopRuleUsageTracking();\n  }\n\n  async mediaQueriesPromise(): Promise<CSSMedia[]> {\n    const {medias} = await this.agent.invoke_getMediaQueries();\n    return medias ? CSSMedia.parseMediaArrayPayload(this, medias) : [];\n  }\n\n  isEnabled(): boolean {\n    return this.#isEnabledInternal;\n  }\n\n  private async enable(): Promise<void> {\n    await this.agent.invoke_enable();\n    this.#isEnabledInternal = true;\n    if (this.#isRuleUsageTrackingEnabled) {\n      await this.startCoverage();\n    }\n    this.dispatchEventToListeners(Events.ModelWasEnabled);\n  }\n\n  async matchedStylesPromise(nodeId: Protocol.DOM.NodeId): Promise<CSSMatchedStyles|null> {\n    const response = await this.agent.invoke_getMatchedStylesForNode({nodeId});\n\n    if (response.getError()) {\n      return null;\n    }\n\n    const node = this.#domModelInternal.nodeForId(nodeId);\n    if (!node) {\n      return null;\n    }\n\n    return new CSSMatchedStyles(\n        this, (node as DOMNode), response.inlineStyle || null, response.attributesStyle || null,\n        response.matchedCSSRules || [], response.pseudoElements || [], response.inherited || [],\n        response.cssKeyframesRules || []);\n  }\n\n  async classNamesPromise(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string[]> {\n    const {classNames} = await this.agent.invoke_collectClassNames({styleSheetId});\n    return classNames || [];\n  }\n\n  computedStylePromise(nodeId: Protocol.DOM.NodeId): Promise<Map<string, string>|null> {\n    return this.#styleLoader.computedStylePromise(nodeId);\n  }\n\n  async backgroundColorsPromise(nodeId: Protocol.DOM.NodeId): Promise<ContrastInfo|null> {\n    const response = await this.agent.invoke_getBackgroundColors({nodeId});\n    if (response.getError()) {\n      return null;\n    }\n\n    return {\n      backgroundColors: response.backgroundColors || null,\n      computedFontSize: response.computedFontSize || '',\n      computedFontWeight: response.computedFontWeight || '',\n    };\n  }\n\n  async platformFontsPromise(nodeId: Protocol.DOM.NodeId): Promise<Protocol.CSS.PlatformFontUsage[]|null> {\n    const {fonts} = await this.agent.invoke_getPlatformFontsForNode({nodeId});\n    return fonts;\n  }\n\n  allStyleSheets(): CSSStyleSheetHeader[] {\n    const values = [...this.#styleSheetIdToHeader.values()];\n    function styleSheetComparator(a: CSSStyleSheetHeader, b: CSSStyleSheetHeader): number {\n      if (a.sourceURL < b.sourceURL) {\n        return -1;\n      }\n      if (a.sourceURL > b.sourceURL) {\n        return 1;\n      }\n      return a.startLine - b.startLine || a.startColumn - b.startColumn;\n    }\n    values.sort(styleSheetComparator);\n\n    return values;\n  }\n\n  async inlineStylesPromise(nodeId: Protocol.DOM.NodeId): Promise<InlineStyleResult|null> {\n    const response = await this.agent.invoke_getInlineStylesForNode({nodeId});\n\n    if (response.getError() || !response.inlineStyle) {\n      return null;\n    }\n    const inlineStyle = new CSSStyleDeclaration(this, null, response.inlineStyle, Type.Inline);\n    const attributesStyle = response.attributesStyle ?\n        new CSSStyleDeclaration(this, null, response.attributesStyle, Type.Attributes) :\n        null;\n    return new InlineStyleResult(inlineStyle, attributesStyle);\n  }\n\n  forcePseudoState(node: DOMNode, pseudoClass: string, enable: boolean): boolean {\n    const forcedPseudoClasses = node.marker<string[]>(PseudoStateMarker) || [];\n    const hasPseudoClass = forcedPseudoClasses.includes(pseudoClass);\n    if (enable) {\n      if (hasPseudoClass) {\n        return false;\n      }\n      forcedPseudoClasses.push(pseudoClass);\n      node.setMarker(PseudoStateMarker, forcedPseudoClasses);\n    } else {\n      if (!hasPseudoClass) {\n        return false;\n      }\n      Platform.ArrayUtilities.removeElement(forcedPseudoClasses, pseudoClass);\n      if (forcedPseudoClasses.length) {\n        node.setMarker(PseudoStateMarker, forcedPseudoClasses);\n      } else {\n        node.setMarker(PseudoStateMarker, null);\n      }\n    }\n\n    if (node.id === undefined) {\n      return false;\n    }\n    this.agent.invoke_forcePseudoState({nodeId: node.id, forcedPseudoClasses});\n    this.dispatchEventToListeners(Events.PseudoStateForced, {node: node, pseudoClass: pseudoClass, enable: enable});\n    return true;\n  }\n\n  pseudoState(node: DOMNode): string[]|null {\n    return node.marker(PseudoStateMarker) || [];\n  }\n\n  async setMediaText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange,\n      newMediaText: string): Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {media} = await this.agent.invoke_setMediaText({styleSheetId, range, text: newMediaText});\n\n      if (!media) {\n        return false;\n      }\n      this.#domModelInternal.markUndoableState();\n      const edit = new Edit(styleSheetId, range, newMediaText, media);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setContainerQueryText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange,\n      newContainerQueryText: string): Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {containerQuery} =\n          await this.agent.invoke_setContainerQueryText({styleSheetId, range, text: newContainerQueryText});\n\n      if (!containerQuery) {\n        return false;\n      }\n      this.#domModelInternal.markUndoableState();\n      const edit = new Edit(styleSheetId, range, newContainerQueryText, containerQuery);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async addRule(styleSheetId: Protocol.CSS.StyleSheetId, ruleText: string, ruleLocation: TextUtils.TextRange.TextRange):\n      Promise<CSSStyleRule|null> {\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {rule} = await this.agent.invoke_addRule({styleSheetId, ruleText, location: ruleLocation});\n\n      if (!rule) {\n        return null;\n      }\n      this.#domModelInternal.markUndoableState();\n      const edit = new Edit(styleSheetId, ruleLocation, ruleText, rule);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return new CSSStyleRule(this, rule);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  async requestViaInspectorStylesheet(node: DOMNode): Promise<CSSStyleSheetHeader|null> {\n    const frameId = node.frameId() ||\n        (this.#resourceTreeModel && this.#resourceTreeModel.mainFrame ? this.#resourceTreeModel.mainFrame.id : null);\n    const headers = [...this.#styleSheetIdToHeader.values()];\n    const styleSheetHeader = headers.find(header => header.frameId === frameId && header.isViaInspector());\n    if (styleSheetHeader) {\n      return styleSheetHeader;\n    }\n    if (!frameId) {\n      return null;\n    }\n\n    try {\n      const {styleSheetId} = await this.agent.invoke_createStyleSheet({frameId});\n      if (!styleSheetId) {\n        return null;\n      }\n      return this.#styleSheetIdToHeader.get(styleSheetId) || null;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  mediaQueryResultChanged(): void {\n    this.dispatchEventToListeners(Events.MediaQueryResultChanged);\n  }\n\n  fontsUpdated(fontFace?: Protocol.CSS.FontFace|null): void {\n    if (fontFace) {\n      this.#fontFacesInternal.set(fontFace.src, new CSSFontFace(fontFace));\n    }\n    this.dispatchEventToListeners(Events.FontsUpdated);\n  }\n\n  fontFaces(): CSSFontFace[] {\n    return [...this.#fontFacesInternal.values()];\n  }\n\n  styleSheetHeaderForId(id: Protocol.CSS.StyleSheetId): CSSStyleSheetHeader|null {\n    return this.#styleSheetIdToHeader.get(id) || null;\n  }\n\n  styleSheetHeaders(): CSSStyleSheetHeader[] {\n    return [...this.#styleSheetIdToHeader.values()];\n  }\n\n  fireStyleSheetChanged(styleSheetId: Protocol.CSS.StyleSheetId, edit?: Edit): void {\n    this.dispatchEventToListeners(Events.StyleSheetChanged, {styleSheetId: styleSheetId, edit: edit});\n  }\n\n  private ensureOriginalStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string|null> {\n    const header = this.styleSheetHeaderForId(styleSheetId);\n    if (!header) {\n      return Promise.resolve(null);\n    }\n    let promise = this.#originalStyleSheetTextInternal.get(header);\n    if (!promise) {\n      promise = this.getStyleSheetText(header.id);\n      this.#originalStyleSheetTextInternal.set(header, promise);\n      this.originalContentRequestedForTest(header);\n    }\n    return promise;\n  }\n\n  private originalContentRequestedForTest(_header: CSSStyleSheetHeader): void {\n  }\n\n  originalStyleSheetText(header: CSSStyleSheetHeader): Promise<string|null> {\n    return this.ensureOriginalStyleSheetText(header.id);\n  }\n\n  getAllStyleSheetHeaders(): Iterable<CSSStyleSheetHeader> {\n    return this.#styleSheetIdToHeader.values();\n  }\n\n  styleSheetAdded(header: Protocol.CSS.CSSStyleSheetHeader): void {\n    console.assert(!this.#styleSheetIdToHeader.get(header.styleSheetId));\n    const styleSheetHeader = new CSSStyleSheetHeader(this, header);\n    this.#styleSheetIdToHeader.set(header.styleSheetId, styleSheetHeader);\n    const url = styleSheetHeader.resourceURL();\n    let frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    if (!frameIdToStyleSheetIds) {\n      frameIdToStyleSheetIds = new Map();\n      this.#styleSheetIdsForURL.set(url, frameIdToStyleSheetIds);\n    }\n    if (frameIdToStyleSheetIds) {\n      let styleSheetIds = frameIdToStyleSheetIds.get(styleSheetHeader.frameId);\n      if (!styleSheetIds) {\n        styleSheetIds = new Set();\n        frameIdToStyleSheetIds.set(styleSheetHeader.frameId, styleSheetIds);\n      }\n      styleSheetIds.add(styleSheetHeader.id);\n    }\n    this.#sourceMapManagerInternal.attachSourceMap(\n        styleSheetHeader, styleSheetHeader.sourceURL, styleSheetHeader.sourceMapURL);\n    this.dispatchEventToListeners(Events.StyleSheetAdded, styleSheetHeader);\n  }\n\n  styleSheetRemoved(id: Protocol.CSS.StyleSheetId): void {\n    const header = this.#styleSheetIdToHeader.get(id);\n    console.assert(Boolean(header));\n    if (!header) {\n      return;\n    }\n    this.#styleSheetIdToHeader.delete(id);\n    const url = header.resourceURL();\n    const frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    console.assert(\n        Boolean(frameIdToStyleSheetIds), 'No frameId to styleSheetId map is available for given style sheet URL.');\n    if (frameIdToStyleSheetIds) {\n      const stylesheetIds = frameIdToStyleSheetIds.get(header.frameId);\n      if (stylesheetIds) {\n        stylesheetIds.delete(id);\n        if (!stylesheetIds.size) {\n          frameIdToStyleSheetIds.delete(header.frameId);\n          if (!frameIdToStyleSheetIds.size) {\n            this.#styleSheetIdsForURL.delete(url);\n          }\n        }\n      }\n    }\n    this.#originalStyleSheetTextInternal.delete(header);\n    this.#sourceMapManagerInternal.detachSourceMap(header);\n    this.dispatchEventToListeners(Events.StyleSheetRemoved, header);\n  }\n\n  getStyleSheetIdsForURL(url: string): Protocol.CSS.StyleSheetId[] {\n    const frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    if (!frameIdToStyleSheetIds) {\n      return [];\n    }\n\n    const result = [];\n    for (const styleSheetIds of frameIdToStyleSheetIds.values()) {\n      result.push(...styleSheetIds);\n    }\n    return result;\n  }\n\n  async setStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId, newText: string, majorChange: boolean):\n      Promise<string|null> {\n    const header = this.#styleSheetIdToHeader.get(styleSheetId);\n    if (!header) {\n      return 'Unknown stylesheet in CSS.setStyleSheetText';\n    }\n    newText = CSSModel.trimSourceURL(newText);\n    if (header.hasSourceURL) {\n      newText += '\\n/*# sourceURL=' + header.sourceURL + ' */';\n    }\n\n    await this.ensureOriginalStyleSheetText(styleSheetId);\n    const response = await this.agent.invoke_setStyleSheetText({styleSheetId: header.id, text: newText});\n    const sourceMapURL = response.sourceMapURL;\n\n    this.#sourceMapManagerInternal.detachSourceMap(header);\n    header.setSourceMapURL(sourceMapURL);\n    this.#sourceMapManagerInternal.attachSourceMap(header, header.sourceURL, header.sourceMapURL);\n    if (sourceMapURL === null) {\n      return 'Error in CSS.setStyleSheetText';\n    }\n    this.#domModelInternal.markUndoableState(!majorChange);\n    this.fireStyleSheetChanged(styleSheetId);\n    return null;\n  }\n\n  async getStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string|null> {\n    try {\n      const {text} = await this.agent.invoke_getStyleSheetText({styleSheetId});\n      return text && CSSModel.trimSourceURL(text);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  private resetStyleSheets(): void {\n    const headers = [...this.#styleSheetIdToHeader.values()];\n    this.#styleSheetIdsForURL.clear();\n    this.#styleSheetIdToHeader.clear();\n    for (const header of headers) {\n      this.#sourceMapManagerInternal.detachSourceMap(header);\n      this.dispatchEventToListeners(Events.StyleSheetRemoved, header);\n    }\n  }\n\n  private resetFontFaces(): void {\n    this.#fontFacesInternal.clear();\n  }\n\n  async suspendModel(): Promise<void> {\n    this.#isEnabledInternal = false;\n    await this.agent.invoke_disable();\n    this.resetStyleSheets();\n    this.resetFontFaces();\n  }\n\n  async resumeModel(): Promise<void> {\n    return this.enable();\n  }\n\n  setEffectivePropertyValueForNode(nodeId: Protocol.DOM.NodeId, propertyName: string, value: string): void {\n    this.agent.invoke_setEffectivePropertyValueForNode({nodeId, propertyName, value});\n  }\n\n  cachedMatchedCascadeForNode(node: DOMNode): Promise<CSSMatchedStyles|null> {\n    if (this.#cachedMatchedCascadeNode !== node) {\n      this.discardCachedMatchedCascade();\n    }\n    this.#cachedMatchedCascadeNode = node;\n    if (!this.#cachedMatchedCascadePromise) {\n      if (node.id) {\n        this.#cachedMatchedCascadePromise = this.matchedStylesPromise(node.id);\n      } else {\n        return Promise.resolve(null);\n      }\n    }\n    return this.#cachedMatchedCascadePromise;\n  }\n\n  discardCachedMatchedCascade(): void {\n    this.#cachedMatchedCascadeNode = null;\n    this.#cachedMatchedCascadePromise = null;\n  }\n\n  createCSSPropertyTracker(propertiesToTrack: Protocol.CSS.CSSComputedStyleProperty[]): CSSPropertyTracker {\n    const cssPropertyTracker = new CSSPropertyTracker(this, propertiesToTrack);\n    return cssPropertyTracker;\n  }\n\n  enableCSSPropertyTracker(cssPropertyTracker: CSSPropertyTracker): void {\n    const propertiesToTrack = cssPropertyTracker.getTrackedProperties();\n    if (propertiesToTrack.length === 0) {\n      return;\n    }\n    this.agent.invoke_trackComputedStyleUpdates({propertiesToTrack});\n    this.#isCSSPropertyTrackingEnabled = true;\n    this.#cssPropertyTracker = cssPropertyTracker;\n    this.pollComputedStyleUpdates();\n  }\n\n  // Since we only support one tracker at a time, this call effectively disables\n  // style tracking.\n  disableCSSPropertyTracker(): void {\n    this.#isCSSPropertyTrackingEnabled = false;\n    this.#cssPropertyTracker = null;\n    // Sending an empty list to the backend signals the close of style tracking\n    this.agent.invoke_trackComputedStyleUpdates({propertiesToTrack: []});\n  }\n\n  private async pollComputedStyleUpdates(): Promise<void> {\n    if (this.#isTrackingRequestPending) {\n      return;\n    }\n\n    if (this.#isCSSPropertyTrackingEnabled) {\n      this.#isTrackingRequestPending = true;\n      const result = await this.agent.invoke_takeComputedStyleUpdates();\n      this.#isTrackingRequestPending = false;\n\n      if (result.getError() || !result.nodeIds || !this.#isCSSPropertyTrackingEnabled) {\n        return;\n      }\n\n      if (this.#cssPropertyTracker) {\n        this.#cssPropertyTracker.dispatchEventToListeners(\n            CSSPropertyTrackerEvents.TrackedCSSPropertiesUpdated,\n            result.nodeIds.map(nodeId => this.#domModelInternal.nodeForId(nodeId)));\n      }\n    }\n\n    if (this.#isCSSPropertyTrackingEnabled) {\n      this.#stylePollingThrottler.schedule(this.pollComputedStyleUpdates.bind(this));\n    }\n  }\n\n  dispose(): void {\n    this.disableCSSPropertyTracker();\n    super.dispose();\n    this.#sourceMapManagerInternal.dispose();\n  }\n\n  getAgent(): ProtocolProxyApi.CSSApi {\n    return this.agent;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  FontsUpdated = 'FontsUpdated',\n  MediaQueryResultChanged = 'MediaQueryResultChanged',\n  ModelWasEnabled = 'ModelWasEnabled',\n  PseudoStateForced = 'PseudoStateForced',\n  StyleSheetAdded = 'StyleSheetAdded',\n  StyleSheetChanged = 'StyleSheetChanged',\n  StyleSheetRemoved = 'StyleSheetRemoved',\n}\n\nexport interface StyleSheetChangedEvent {\n  styleSheetId: Protocol.CSS.StyleSheetId;\n  edit?: Edit;\n}\n\nexport interface PseudoStateForcedEvent {\n  node: DOMNode;\n  pseudoClass: string;\n  enable: boolean;\n}\n\nexport type EventTypes = {\n  [Events.FontsUpdated]: void,\n  [Events.MediaQueryResultChanged]: void,\n  [Events.ModelWasEnabled]: void,\n  [Events.PseudoStateForced]: PseudoStateForcedEvent,\n  [Events.StyleSheetAdded]: CSSStyleSheetHeader,\n  [Events.StyleSheetChanged]: StyleSheetChangedEvent,\n  [Events.StyleSheetRemoved]: CSSStyleSheetHeader,\n};\n\nconst PseudoStateMarker = 'pseudo-state-marker';\n\nexport class Edit {\n  styleSheetId: string;\n  oldRange: TextUtils.TextRange.TextRange;\n  newRange: TextUtils.TextRange.TextRange;\n  newText: string;\n  payload: Object|null;\n  constructor(styleSheetId: string, oldRange: TextUtils.TextRange.TextRange, newText: string, payload: Object|null) {\n    this.styleSheetId = styleSheetId;\n    this.oldRange = oldRange;\n    this.newRange = TextUtils.TextRange.TextRange.fromEdit(oldRange, newText);\n    this.newText = newText;\n    this.payload = payload;\n  }\n}\n\nexport class CSSLocation {\n  readonly #cssModelInternal: CSSModel;\n  styleSheetId: Protocol.CSS.StyleSheetId;\n  url: string;\n  lineNumber: number;\n  columnNumber: number;\n  constructor(header: CSSStyleSheetHeader, lineNumber: number, columnNumber?: number) {\n    this.#cssModelInternal = header.cssModel();\n    this.styleSheetId = header.id;\n    this.url = header.resourceURL();\n    this.lineNumber = lineNumber;\n    this.columnNumber = columnNumber || 0;\n  }\n\n  cssModel(): CSSModel {\n    return this.#cssModelInternal;\n  }\n\n  header(): CSSStyleSheetHeader|null {\n    return this.#cssModelInternal.styleSheetHeaderForId(this.styleSheetId);\n  }\n}\n\nclass CSSDispatcher implements ProtocolProxyApi.CSSDispatcher {\n  readonly #cssModel: CSSModel;\n  constructor(cssModel: CSSModel) {\n    this.#cssModel = cssModel;\n  }\n\n  mediaQueryResultChanged(): void {\n    this.#cssModel.mediaQueryResultChanged();\n  }\n\n  fontsUpdated({font}: Protocol.CSS.FontsUpdatedEvent): void {\n    this.#cssModel.fontsUpdated(font);\n  }\n\n  styleSheetChanged({styleSheetId}: Protocol.CSS.StyleSheetChangedEvent): void {\n    this.#cssModel.fireStyleSheetChanged(styleSheetId);\n  }\n\n  styleSheetAdded({header}: Protocol.CSS.StyleSheetAddedEvent): void {\n    this.#cssModel.styleSheetAdded(header);\n  }\n\n  styleSheetRemoved({styleSheetId}: Protocol.CSS.StyleSheetRemovedEvent): void {\n    this.#cssModel.styleSheetRemoved(styleSheetId);\n  }\n}\n\nclass ComputedStyleLoader {\n  #cssModel: CSSModel;\n  #nodeIdToPromise: Map<number, Promise<Map<string, string>|null>>;\n  constructor(cssModel: CSSModel) {\n    this.#cssModel = cssModel;\n    this.#nodeIdToPromise = new Map();\n  }\n\n  computedStylePromise(nodeId: Protocol.DOM.NodeId): Promise<Map<string, string>|null> {\n    let promise = this.#nodeIdToPromise.get(nodeId);\n    if (promise) {\n      return promise;\n    }\n    promise = this.#cssModel.getAgent().invoke_getComputedStyleForNode({nodeId}).then(({computedStyle}) => {\n      this.#nodeIdToPromise.delete(nodeId);\n      if (!computedStyle || !computedStyle.length) {\n        return null;\n      }\n      const result = new Map<string, string>();\n      for (const property of computedStyle) {\n        result.set(property.name, property.value);\n      }\n      return result;\n    });\n    this.#nodeIdToPromise.set(nodeId, promise);\n    return promise;\n  }\n}\n\nexport class InlineStyleResult {\n  inlineStyle: CSSStyleDeclaration|null;\n  attributesStyle: CSSStyleDeclaration|null;\n  constructor(inlineStyle: CSSStyleDeclaration|null, attributesStyle: CSSStyleDeclaration|null) {\n    this.inlineStyle = inlineStyle;\n    this.attributesStyle = attributesStyle;\n  }\n}\n\nexport class CSSPropertyTracker extends Common.ObjectWrapper.ObjectWrapper<CSSPropertyTrackerEventTypes> {\n  readonly #cssModel: CSSModel;\n  readonly #properties: Protocol.CSS.CSSComputedStyleProperty[];\n  constructor(cssModel: CSSModel, propertiesToTrack: Protocol.CSS.CSSComputedStyleProperty[]) {\n    super();\n    this.#cssModel = cssModel;\n    this.#properties = propertiesToTrack;\n  }\n\n  start(): void {\n    this.#cssModel.enableCSSPropertyTracker(this);\n  }\n\n  stop(): void {\n    this.#cssModel.disableCSSPropertyTracker();\n  }\n\n  getTrackedProperties(): Protocol.CSS.CSSComputedStyleProperty[] {\n    return this.#properties;\n  }\n}\n\nconst StylePollingInterval = 1000;  // throttling interval for style polling, in milliseconds\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum CSSPropertyTrackerEvents {\n  TrackedCSSPropertiesUpdated = 'TrackedCSSPropertiesUpdated',\n}\n\nexport type CSSPropertyTrackerEventTypes = {\n  [CSSPropertyTrackerEvents.TrackedCSSPropertiesUpdated]: (DOMNode|null)[],\n};\n\nSDKModel.register(CSSModel, {capabilities: Capability.DOM, autostart: true});\nexport interface ContrastInfo {\n  backgroundColors: string[]|null;\n  computedFontSize: string;\n  computedFontWeight: string;\n}\n"]}