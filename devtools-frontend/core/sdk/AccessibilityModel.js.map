{"version":3,"file":"AccessibilityModel.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/AccessibilityModel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Protocol from '../../generated/protocol.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\n\nimport type {DOMNode} from './DOMModel.js';\nimport {DOMModel} from './DOMModel.js';\nimport {DeferredDOMNode} from './DOMModel.js';\nimport type {Target} from './Target.js';\nimport {Capability} from './Target.js';\nimport {SDKModel} from './SDKModel.js';\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum CoreAxPropertyName {\n  Name = 'name',\n  Description = 'description',\n  Value = 'value',\n  Role = 'role',\n}\n\nexport interface CoreOrProtocolAxProperty {\n  name: CoreAxPropertyName|Protocol.Accessibility.AXPropertyName;\n  value: Protocol.Accessibility.AXValue;\n}\n\nexport class AccessibilityNode {\n  readonly #accessibilityModelInternal: AccessibilityModel;\n  readonly #agent: ProtocolProxyApi.AccessibilityApi;\n  readonly #idInternal: Protocol.Accessibility.AXNodeId;\n  readonly #backendDOMNodeIdInternal: Protocol.DOM.BackendNodeId|null;\n  readonly #deferredDOMNodeInternal: DeferredDOMNode|null;\n  readonly #ignoredInternal: boolean;\n  readonly #ignoredReasonsInternal: Protocol.Accessibility.AXProperty[]|undefined;\n  readonly #roleInternal: Protocol.Accessibility.AXValue|null;\n  readonly #nameInternal: Protocol.Accessibility.AXValue|null;\n  readonly #descriptionInternal: Protocol.Accessibility.AXValue|null;\n  readonly #valueInternal: Protocol.Accessibility.AXValue|null;\n  readonly #propertiesInternal: Protocol.Accessibility.AXProperty[]|null;\n  #childIds: string[]|null;\n  #parentNodeInternal: AccessibilityNode|null;\n\n  constructor(accessibilityModel: AccessibilityModel, payload: Protocol.Accessibility.AXNode) {\n    this.#accessibilityModelInternal = accessibilityModel;\n    this.#agent = accessibilityModel.getAgent();\n\n    this.#idInternal = payload.nodeId;\n    accessibilityModel.setAXNodeForAXId(this.#idInternal, this);\n    if (payload.backendDOMNodeId) {\n      accessibilityModel.setAXNodeForBackendDOMNodeId(payload.backendDOMNodeId, this);\n      this.#backendDOMNodeIdInternal = payload.backendDOMNodeId;\n      this.#deferredDOMNodeInternal = new DeferredDOMNode(accessibilityModel.target(), payload.backendDOMNodeId);\n    } else {\n      this.#backendDOMNodeIdInternal = null;\n      this.#deferredDOMNodeInternal = null;\n    }\n    this.#ignoredInternal = payload.ignored;\n    if (this.#ignoredInternal && 'ignoredReasons' in payload) {\n      this.#ignoredReasonsInternal = payload.ignoredReasons;\n    }\n\n    this.#roleInternal = payload.role || null;\n    this.#nameInternal = payload.name || null;\n    this.#descriptionInternal = payload.description || null;\n    this.#valueInternal = payload.value || null;\n    this.#propertiesInternal = payload.properties || null;\n    this.#childIds = payload.childIds || null;\n    this.#parentNodeInternal = null;\n  }\n\n  id(): Protocol.Accessibility.AXNodeId {\n    return this.#idInternal;\n  }\n\n  accessibilityModel(): AccessibilityModel {\n    return this.#accessibilityModelInternal;\n  }\n\n  ignored(): boolean {\n    return this.#ignoredInternal;\n  }\n\n  ignoredReasons(): Protocol.Accessibility.AXProperty[]|null {\n    return this.#ignoredReasonsInternal || null;\n  }\n\n  role(): Protocol.Accessibility.AXValue|null {\n    return this.#roleInternal || null;\n  }\n\n  coreProperties(): CoreOrProtocolAxProperty[] {\n    const properties: CoreOrProtocolAxProperty[] = [];\n\n    if (this.#nameInternal) {\n      properties.push({name: CoreAxPropertyName.Name, value: this.#nameInternal});\n    }\n    if (this.#descriptionInternal) {\n      properties.push({name: CoreAxPropertyName.Description, value: this.#descriptionInternal});\n    }\n    if (this.#valueInternal) {\n      properties.push({name: CoreAxPropertyName.Value, value: this.#valueInternal});\n    }\n\n    return properties;\n  }\n\n  name(): Protocol.Accessibility.AXValue|null {\n    return this.#nameInternal || null;\n  }\n\n  description(): Protocol.Accessibility.AXValue|null {\n    return this.#descriptionInternal || null;\n  }\n\n  value(): Protocol.Accessibility.AXValue|null {\n    return this.#valueInternal || null;\n  }\n\n  properties(): Protocol.Accessibility.AXProperty[]|null {\n    return this.#propertiesInternal || null;\n  }\n\n  parentNode(): AccessibilityNode|null {\n    return this.#parentNodeInternal;\n  }\n\n  setParentNode(parentNode: AccessibilityNode|null): void {\n    this.#parentNodeInternal = parentNode;\n  }\n\n  isDOMNode(): boolean {\n    return Boolean(this.#backendDOMNodeIdInternal);\n  }\n\n  backendDOMNodeId(): Protocol.DOM.BackendNodeId|null {\n    return this.#backendDOMNodeIdInternal;\n  }\n\n  deferredDOMNode(): DeferredDOMNode|null {\n    return this.#deferredDOMNodeInternal;\n  }\n\n  highlightDOMNode(): void {\n    const deferredNode = this.deferredDOMNode();\n    if (!deferredNode) {\n      return;\n    }\n    // Highlight node in page.\n    deferredNode.highlight();\n  }\n\n  children(): AccessibilityNode[] {\n    if (!this.#childIds) {\n      return [];\n    }\n\n    const children = [];\n    for (const childId of this.#childIds) {\n      const child = this.#accessibilityModelInternal.axNodeForId(childId);\n      if (child) {\n        children.push(child);\n      }\n    }\n\n    return children;\n  }\n\n  numChildren(): number {\n    if (!this.#childIds) {\n      return 0;\n    }\n    return this.#childIds.length;\n  }\n\n  hasOnlyUnloadedChildren(): boolean {\n    if (!this.#childIds || !this.#childIds.length) {\n      return false;\n    }\n\n    return this.#childIds.every(id => this.#accessibilityModelInternal.axNodeForId(id) === null);\n  }\n\n  // Only the root node gets a frameId, so nodes have to walk up the tree to find their frameId.\n  getFrameId(): Protocol.Page.FrameId|null {\n    const domNode = this.accessibilityModel().domNodeforAXNode(this);\n    if (!domNode) {\n      return null;\n    }\n    return domNode.frameId();\n  }\n}\n\nexport class AccessibilityModel extends SDKModel<void> {\n  agent: ProtocolProxyApi.AccessibilityApi;\n  #axIdToAXNode: Map<string, AccessibilityNode>;\n  readonly #backendDOMNodeIdToAXNode: Map<Protocol.DOM.BackendNodeId, AccessibilityNode>;\n  readonly #backendDOMNodeIdToDOMNode: Map<Protocol.DOM.BackendNodeId, DOMNode|null>;\n\n  constructor(target: Target) {\n    super(target);\n    this.agent = target.accessibilityAgent();\n    this.resumeModel();\n\n    this.#axIdToAXNode = new Map();\n    this.#backendDOMNodeIdToAXNode = new Map();\n    this.#backendDOMNodeIdToDOMNode = new Map();\n  }\n\n  clear(): void {\n    this.#axIdToAXNode.clear();\n  }\n\n  async resumeModel(): Promise<void> {\n    await this.agent.invoke_enable();\n  }\n\n  async suspendModel(): Promise<void> {\n    await this.agent.invoke_disable();\n  }\n\n  async requestPartialAXTree(node: DOMNode): Promise<void> {\n    const {nodes} = await this.agent.invoke_getPartialAXTree({nodeId: node.id, fetchRelatives: true});\n    if (!nodes) {\n      return;\n    }\n\n    for (const payload of nodes) {\n      new AccessibilityNode(this, payload);\n    }\n\n    for (const axNode of this.#axIdToAXNode.values()) {\n      for (const axChild of axNode.children()) {\n        axChild.setParentNode(axNode);\n      }\n    }\n  }\n\n  private async pushNodesToFrontend(backendIds: Set<Protocol.DOM.BackendNodeId>): Promise<void> {\n    const domModel = this.target().model(DOMModel);\n    if (!domModel) {\n      return;\n    }\n    const newNodesToTrack = await domModel.pushNodesByBackendIdsToFrontend(backendIds);\n    newNodesToTrack?.forEach((value, key) => this.#backendDOMNodeIdToDOMNode.set(key, value));\n  }\n\n  private createNodesFromPayload(payloadNodes: Protocol.Accessibility.AXNode[]): AccessibilityNode[] {\n    const backendIds: Set<Protocol.DOM.BackendNodeId> = new Set();\n    const accessibilityNodes = payloadNodes.map(node => {\n      const sdkNode = new AccessibilityNode(this, node);\n      const backendId = sdkNode.backendDOMNodeId();\n      if (backendId) {\n        backendIds.add(backendId);\n      }\n      return sdkNode;\n    });\n    this.pushNodesToFrontend(backendIds);\n\n    for (const sdkNode of accessibilityNodes) {\n      for (const sdkChild of sdkNode.children()) {\n        sdkChild.setParentNode(sdkNode);\n      }\n    }\n    return accessibilityNodes;\n  }\n\n  async requestRootNode(depth: number = 2, frameId?: Protocol.Page.FrameId): Promise<AccessibilityNode|undefined> {\n    const {nodes} = await this.agent.invoke_getFullAXTree({depth, frameId});\n    if (!nodes) {\n      return;\n    }\n    const axNodes = this.createNodesFromPayload(nodes);\n    const root = axNodes[0];\n    return root;\n  }\n\n  async requestAXChildren(nodeId: Protocol.Accessibility.AXNodeId, frameId?: Protocol.Page.FrameId):\n      Promise<AccessibilityNode[]> {\n    const {nodes} = await this.agent.invoke_getChildAXNodes({id: nodeId, frameId});\n    if (!nodes) {\n      return [];\n    }\n    const axNodes = this.createNodesFromPayload(nodes);\n    return axNodes;\n  }\n\n  async requestAndLoadSubTreeToNode(node: DOMNode): Promise<AccessibilityNode|null> {\n    // Node may have already been loaded, so don't bother requesting it again.\n    const loadedAXNode = this.axNodeForDOMNode(node);\n    if (loadedAXNode) {\n      return loadedAXNode;\n    }\n\n    const {nodes} = await this.agent.invoke_getPartialAXTree({nodeId: node.id, fetchRelatives: true});\n    if (!nodes) {\n      return null;\n    }\n    const ancestors = this.createNodesFromPayload(nodes);\n    // Request top level children nodes.\n    for (const node of ancestors) {\n      await this.requestAXChildren(node.id());\n    }\n\n    return this.axNodeForDOMNode(node);\n  }\n\n  async updateSubtreeAndAncestors(backendNodeId: Protocol.DOM.BackendNodeId): Promise<void> {\n    const {nodes} = await this.agent.invoke_getPartialAXTree({backendNodeId, fetchRelatives: true});\n    if (!nodes) {\n      return;\n    }\n    this.createNodesFromPayload(nodes);\n  }\n\n  axNodeForId(axId: string): AccessibilityNode|null {\n    return this.#axIdToAXNode.get(axId) || null;\n  }\n\n  setAXNodeForAXId(axId: string, axNode: AccessibilityNode): void {\n    this.#axIdToAXNode.set(axId, axNode);\n  }\n\n  axNodeForDOMNode(domNode: DOMNode|null): AccessibilityNode|null {\n    if (!domNode) {\n      return null;\n    }\n    return this.#backendDOMNodeIdToAXNode.get(domNode.backendNodeId()) ?? null;\n  }\n\n  domNodeforAXNode(axNode: AccessibilityNode): DOMNode|null {\n    const backendDOMNodeId = axNode.backendDOMNodeId();\n    if (!backendDOMNodeId) {\n      return null;\n    }\n    return this.#backendDOMNodeIdToDOMNode.get(backendDOMNodeId) ?? null;\n  }\n\n  setAXNodeForBackendDOMNodeId(backendDOMNodeId: Protocol.DOM.BackendNodeId, axNode: AccessibilityNode): void {\n    this.#backendDOMNodeIdToAXNode.set(backendDOMNodeId, axNode);\n  }\n\n  getAgent(): ProtocolProxyApi.AccessibilityApi {\n    return this.agent;\n  }\n}\n\nSDKModel.register(AccessibilityModel, {capabilities: Capability.DOM, autostart: false});\n"]}